<!-- javascript -->
<script type="text/javascript" src="../Scripts/jquery-1.9.1.js"></script>
<script type="text/javascript" src="../Scripts/jquery.mayaminer.util.min.js"></script>
<script type="text/javascript" src="../Scripts/jQueryUI/jquery-ui.js"></script>
<script type="text/javascript" src="../Scripts/jQueryUI/jquery-ui-timepicker-addon.js"></script>
<script type="text/javascript" src="../Scripts/jQueryUI/jquery-ui-sliderAccess.js"></script>
<script type="text/javascript" src="../Scripts/jquery.switchButton.js"></script>
<script type="text/javascript" src="../Scripts/JSTool.js?20190401161123"></script>
<script type="text/javascript" src="../Scripts/mayaminer.jstool.datetime.min.js"></script>
<script type="text/javascript" src="../Scripts/raphael-min.js"></script>
<script type="text/javascript" src="../Scripts/jquery.imgareaselect.min.js"></script>
<script type="text/javascript" src="../Scripts/jquery.blockUI.js"></script>
<script type="text/javascript" src="../Scripts/moment.js?20190401161123"></script>
<script type="text/javascript" src="../Scripts/jquery.jqGrid.js"></script>
<script type="text/javascript" src="../Scripts/i18n/grid.locale-tw.js"></script>

<script>



var GlobalModuleID="";

var Timeout_Count = 0;

var Item_Check1 = 0;

var GlobalKeyWord = "";

var GlobalKeyWord_drug = "";

var GlobalSDate = "";

var GlobalEDate = "";

var GlobalSTime = "";

var GlobalETime = "";

var GlobalPageName = "";

var GlobalFunc = "";

var GlobalArea = 0;
//alert("BO");
var GlobalFee_no = "";

var iframeobject = "";

//第一次查詢要執行兩次
var QueryPageNumber = 0;

//網頁記憶性 Q -> M
var RealModelID = "";

var aModelID = "";
var aUserid = "";
var avType = "";
var avURL = "";

//解決查詢BUG 不在跳一次網頁 這樣會造成帶值有錯誤
var PURL = "";
var FNum = "";
var PCheck = false;
var FCheck = false;

pp();

function pp(){
	//alert("check!");
	//alert("無限迴圈");
	checkUser(5);
	setTimeout('pp();',5000);
}

//清除全域變數的值
function Global_delete(){
        GlobalModuleID = "";
        GlobalKeyWord = "";
        GlobalSDate = "";
        GlobalEDate = "";
        GlobalSTime = "";
        GlobalETime = "";
        GlobalPageName = "";
        GlobalFunc = "";
        GlobalArea = 0;
        GlobalFee_no = "";
        RealModelID = "";
        PCheck = false;
        FCheck = false;
        //alert("清除參數~!"+GlobalModuleID+GlobalKeyWord+GlobalSDate+GlobalEDate+GlobalSTime+GlobalETime);
}

function check_page(){
    //mainContent
    //parent.f2.document.iframe
   //parent.f2.document.all("iframe id");
    
    iframeobject = parent.f2.document.all("mainContent").contentWindow;

    //檢查查詢頁面的start_date參數是否存在
        var done=0;
        //alert("這裡是check_page");
        if (Timeout_Count>2){ //這行不得不加
                //alert("有近來Timeout_Count");
                //alert("Timeout_Count>1");
           //if (Item_Check1 == 1){

            // if(QueryPageNumber==0){
            //     alert("再飛一次XDD1?");
            //     alert("aModelID = " + aModelID + " ,aUserid = " + aUserid + " ,avType = " + avType + " ,avURL = " + avURL);
            //     setTimeout(JNP(aModelID, aUserid, avType, avURL),2000);
            //     QueryPageNumber == 1;
            // }
                //alert("Item_Check1 == 1");
                //alert("GlobalModuleID = " + GlobalModuleID)
                if (GlobalModuleID=="Q03"){
                    //alert("這裡是查詢Q03");
                //if(parent.f3.document.all("btn_sign").disabled){
                //    alert("這裡是文字醫囑，Button被Disabled");
                //}
                    //文字醫囑 item 選擇 (OK)
                    //20190802 如果已偵測到長期醫囑item有被觸發，則是代表網頁Loading完成，則進行item選擇。

                    if(iframeobject.document.all("showR").checked && iframeobject.document.all("btn_sign").disabled || PCheck){
                    	//20190927 peter 解決item無法選擇之問題
                        Item_Check1 = 0;
                        //初始化為0，避免重複執行
                        Timeout_Count=0;
                        done=1;
                        //alert("done = 1 , GlobalKeyWord = " + GlobalKeyWord);
                        //alert("這裡是查詢Q03，if判斷式裡面, GlobalKeyWord = " + GlobalKeyWord);
                       if(GlobalKeyWord == "長期醫囑"){
                            //var iframeobject = parent.f2.document.all("iframe id");
                            //iframeobject
                             iframeobject.document.all("showR").checked = true;
    　                       iframeobject.showordertype('R');
                        }else if(GlobalKeyWord == "三天內臨時醫囑"){
                             iframeobject.document.all("showS").checked = true;
    　                       iframeobject.showordertype('S');
                        }else if(GlobalKeyWord == "DC醫囑"){
                             iframeobject.document.all("showDC").checked = true;
    　                       iframeobject.showordertype('DC');
                        }else if(GlobalKeyWord == "全部臨時醫囑"){
                             iframeobject.document.all("showS_all").checked = true;
                             iframeobject.ckAllS();
                        }else if(GlobalKeyWord == "出院醫囑"){
                             iframeobject.document.all("show_leave").checked = true;
                             iframeobject.showordertype('D');
                        }else if(GlobalKeyWord == "全部醫囑"){
                             iframeobject.document.all("show_all").checked = true;
                             iframeobject.showordertype('all');
                        }

                        Global_delete();
 						PCheck = false;
                    }
 
                }
                if (GlobalModuleID=="Q04"){
                   //藥品醫囑 item 選擇
                   //alert("這裡是查詢Q04");
                   //alert("這裡是查詢Q04，if判斷式外面, GlobalKeyWord = " + GlobalKeyWord);
                    //var iframeobject = parent.f2.document.all("mainContent").contentWindow;
                    //alert("iframeobject2 = " + iframeobject);
                    //alert("iframeobject = " + iframeobject.document.all("showR").checked);
                    //alert("iframeobject = " + iframeobject.src);
                    //alert("parent.f2.document.all(inHistory) = " + parent.f2.document.all("inHistory").value);
                    // var vvv = parent.f2.document.all("inHistory");
                    // alert("vvv.all(inHistory) = " + vvv.all("inHistory)");
                    // alert("iframeobject.parent.f2.document.all(showR) = " + iframeobject.all("showR"));


                   //alert("window.parent.f3.document.getElementById(showR).value = " + window.parent.document.getElementById("showR").value);
                   //alert("parent.f2.document.all(showR).value = " + parent.f2.document.all(showR).value);
                   //alert("parent.f2.document.all(showR).checked = " + parent.f2.document.all("showR").checked);
                   //alert("parent.f2.document.all(btn_excute).disabled = " + parent.f2.document.all("btn_excute").disabled);
                   //20190802 如果已偵測到長期醫囑item有被觸發，則是代表網頁Loading完成，則進行item選擇。
                   if(iframeobject.document.all("showR").checked && iframeobject.document.all("btn_excute").disabled || PCheck){
                   	        Item_Check1 = 0;
                            //初始化為0，避免重複執行
                            Timeout_Count=0;
                            done=1;
                    //alert("這裡是查詢Q04，if判斷式裡面, GlobalKeyWord = " + GlobalKeyWord);
                       if(GlobalKeyWord == "長期醫囑"){
                             iframeobject.document.all("showR").checked = true;
    　                       iframeobject.showordertype('R');
                        }else if(GlobalKeyWord == "臨時醫囑"){
                             iframeobject.document.all("showS").checked = true;
    　                       iframeobject.showordertype('S');
                            //alert("臨時醫囑有被選擇")
                        }else if(GlobalKeyWord == "DC醫囑"){
                             iframeobject.document.all("showD").checked = true;
    　                       iframeobject.showordertype('D');
                        }
                        Global_delete();
                        PCheck = false;
                        //alert("showR = " + iframeobject.document.all("showR").checked + "showS = " + iframeobject.document.all("showS").checked + "showD = "+ iframeobject.document.all("showD").checked);

                   }else{
                    //alert("沒有東西啦");
                   }
                }  //Q04
 
 
                if (GlobalModuleID=="Q05"){ //生命徵象
                    //alert("這裡是查詢Q05，生命徵象");
                    if (iframeobject.document.all("stDate")){

                    Item_Check1 = 0;
                    Timeout_Count=0;
                    done=1;
                    //存在，就填入值
                    // iframeobject.document.all("stDate").value= GlobalSDate;
                    // iframeobject.document.all("edDate").value= GlobalEDate;
                    // iframeobject.document.all("stTime").value= GlobalSTime;
                    // iframeobject.document.all("edTime").value= GlobalETime;

                    //生命徵象(OK) 無資料，尚未驗證
                    //alert("GlobalModuleID=Q05")
                    //parent.f3.loading_change();
                    //換整頁(location.href) 20190729
                    //iframeobject.loading_change();
                    //window.location.href = 'VitalSign_Index?starttime=' + $('#stDate').val() + ' ' + $('#stTime').val() + '&endtime=' + $('#edDate').val() + ' ' + $('#edTime').val();

                    //alert("iframeobject.src = " + iframeobject.src);
                    //window.open('../VitalSign/VitalSign_Index?starttime=' +  GlobalSDate + ' ' + GlobalSTime + '&endtime=' + GlobalEDate + ' ' + GlobalETime);

                    //peter20191112
                    //這裡不能使用contentWindow，因為已經先抓到物件了，iframeobject.src會無法抓到網址，(註記:iFrame是使用src，而主頁面是使用location.href)
                    parent.f2.document.all("mainContent").src = '../VitalSign/VitalSign_Index?starttime=' +  GlobalSDate + ' ' + GlobalSTime + '&endtime=' + GlobalEDate + ' ' + GlobalETime;

                    Global_delete();
                    //iframeobject.src = '../VitalSign/VitalSign_Index?starttime=' +  GlobalSDate + ' ' + GlobalSTime + '&endtime=' + GlobalEDate + ' ' + GlobalETime;

                    //window.parent.open_cover();
                    //iframeobject.parent.open_cover();
                    //alert(3);
                    //parent.f3 = 'TubeManage/Assessment_List?starttime=' +  GlobalSDate + ' ' + GlobalSTime + '&endtime=' + GlobalEDate + ' ' + GlobalETime;
                    //window.parent.open_cover();
                    //初始化為0，避免重複執行

                    }
              }
 
                if (GlobalModuleID=="Q01"){ //TPR Sheet

                    if (parent.f2.document.all("mainContent").contentWindow){
               		if (parent.f2.document.all("mainContent").contentWindow.$("#partial_tpr")){
                    //alert("這裡是查詢Q01");
                    if (iframeobject.document.all("start_date")){

                    		


                   	Timeout_Count=0;
	                    done=1;
	                    Item_Check1 = 0;
                    //存在，就填入值
                    // iframeobject.document.all("start_date").value= GlobalSDate;
                    // iframeobject.document.all("end_date").value= GlobalEDate;
                    //iframeobject.document.all("start_time").value= GlobalSTime;
                    //iframeobject.document.all("end_time").value= GlobalETime;
                    //TPR(OK)

                    //peter20191112
                    //'Partial_Tpr?feeno=' + 'I0332966' + '&start=' + $('#start_date').val() + '&end=' + $('#end_date').val() + '&print_set=';
                    //alert(3);
                    //alert("GlobalFee_no = " + GlobalFee_no);
                    //window.open('../VitalSign/Partial_Tpr?feeno=' +  GlobalFee_no + '&start=' + GlobalSDate + '&end=' + GlobalEDate + '&print_set=');
                    //alert(1);

                    //parent.f2.document.all("mainContent").src = '../VitalSign/Partial_Tpr?feeno=' +  GlobalFee_no + '&start=' + GlobalSDate + '&end=' + GlobalEDate + '&print_set=';
                    // var res1 = moment(GlobalSDate).format('YYYY-MM-DD');
                    // var res2 = moment(GlobalEDate).format('YYYY-MM-DD');
                    // var url = '../VitalSign/Partial_Tpr?feeno=' +  GlobalFee_no + '&start=' + res1 + '&end=' + res2 + '&print_set=';
                    var url = '../VitalSign/Partial_Tpr?feeno=' +  GlobalFee_no + '&start=' + GlobalSDate + '&end=' + GlobalEDate + '&print_set=';
                    //alert(2);
                     //alert(parent.f2.document.all("mainContent"));
                     //alert(parent.f2.document.all("mainContent").contentWindow);
                     //alert(parent.f2.document.all("mainContent").contentWindow.$("#partial_tpr"));
                     parent.f2.document.all("mainContent").contentWindow.$("#partial_tpr").load(url, function () {
                        
                    });
                    //alert(iframeobject.document.all("start_date"));

                    iframeobject.document.all("start_date").value= GlobalSDate;
                    iframeobject.document.all("end_date").value= GlobalEDate;

					//alert(4);
                    // var btn_list = parent.f2.document.all("mainContent").contentWindow.$('.btn_m');
                    // for (var i = 0; i < btn_list.length; i++) {
                    //     parent.f2.document.all("mainContent").contentWindow.set_click(btn_list[i]);
                    // }

                    //parent.f2.document.all("mainContent").src = '../VitalSign/Partial_Tpr?feeno=' +  GlobalFee_no + '&start=' + GlobalSDate + '&end=' + GlobalEDate + '&print_set=';
                    //alert(2);
                    //parent.f2.document.all("mainContent").contentWindow.$('#partial_tpr').fadeIn(500);
                    //alert(3);
                    //iframeobject.reload_div();

	                //初始化為0，避免重複執行
	                Global_delete();

                    //alert("TPR OK");


                    		}
                    	}
 
 
                    }

                }//Q01
                if (GlobalModuleID=="Q02"){ //護理紀錄
                    //alert("這裡是查詢Q02，護理紀錄");
                 if (iframeobject.document.all("start_date")){

                 	Timeout_Count=0;
                    done=1;
                    Item_Check1 = 0;
                    //alert("done = " + done);
                    //存在，就填入值
                    iframeobject.document.all("start_date").value= GlobalSDate;
                    iframeobject.document.all("end_date").value= GlobalEDate;
                    iframeobject.document.all("start_time").value= GlobalSTime;
                    iframeobject.document.all("end_time").value= GlobalETime;
                    //alert("已經填入日期參數");
                    //護理記錄(OK)
                    iframeobject.loading_change();
                    //alert("護理紀錄");
					//alert("這裡是查詢Q02，護理紀錄裡面");
					                    //初始化為0，避免重複執行
                    Global_delete();
                    }
                } //Q02
                if (GlobalModuleID=="Q06"){ //給藥作業
 
                    //alert("這裡是查詢Q06");
                    if (iframeobject.document.all("start_date") && iframeobject.document.all("select_all_order").checked || PCheck){

                    Timeout_Count=0;
                    done=1;
                    Item_Check1 = 0;

                    //存在，就填入值
                    iframeobject.document.all("start_date").value= GlobalSDate;
                    iframeobject.document.all("end_date").value= GlobalEDate;
                    iframeobject.document.all("start_time").value= GlobalSTime;
                    iframeobject.document.all("end_time").value= GlobalETime;
                    //給藥 (OK)
                    //alert("這裡是查詢給藥 , select_all_order有被選擇")
                    GlobalKeyWord_drug = GlobalKeyWord;
                    //alert("GlobalKeyWord_drug = " + GlobalKeyWord_drug);

                    //要先選擇已DC 這樣才可以確認按下查詢已後 是否有網頁有載入完成
                    iframeobject.document.all("select_del_order").checked = true;
 
                    select_item_vv();

                   //parent.f3.loading_change();

                    //篩選內容
                    //st
                    //alert(window.parent.f3.document.getElementsByClassName("funcArea")[0].parentNode.innerHTML);
                    //window.parent.f3.document.getElementsByClassName("funcArea")[0]=function (){
                    //    alert(“===onbeforeunload===”);
                    //if(event.clientX>document.body.clientWidth && event.clientY < 0 || event.altKey){
                    //    alert(“你關閉了瀏覽器”);
                    //}else{
                    //    alert(“你正在重新整理頁面”);
                    //}
                    //}
                    //ed
                    }
                } //Q06
                if (GlobalModuleID=="Q07"){ //管路評估
                    //alert("這裡是查詢Q07");
                    if (iframeobject.document.all("start_date") && window.iframeobject.document.getElementsByName("ass_type")[0].checked || PCheck){

                    	Timeout_Count=0;
	                    done=1;
	                    Item_Check1 = 0;
                    //存在，就填入值
 
                    //alert("GlobalSDate = " + GlobalSDate + " " + "GlobalEDate = " + GlobalEDate + " " + "GlobalSTime = " + GlobalSTime + "GlobalETime = " + GlobalETime)
 
                    //alert("start_date = " + parent.f3.document.all("start_date").value)
                    //alert("end_date = " + parent.f3.document.all("end_date").value)
                    //alert("start_time = " + parent.f3.document.all("start_time").value)
                    //alert("end_time = " + parent.f3.document.all("end_time").value)
 
                    //按下查詢就會自動帶入時間參數
                    //parent.f3.document.all("start_date").value= GlobalSDate;
                    //parent.f3.document.all("end_date").value= GlobalEDate;
                    //parent.f3.document.all("start_time").value= GlobalSTime;
                    //parent.f3.document.all("end_time").value= GlobalETime;
 
                    //管路評估 尚未驗證，沒有資料 (OK)
                    //alert("這裡是查詢管路評估");
 
                    //%20 = 空格
                    //"../TubeManage/Assessment_List?starttime=2019/10/1 10:00&endtime=2019/10/20 10:01"
                    //"../TubeManage/Assessment_List?starttime=" + GlobalSDate + " " + GlobalSTime + "&endtime=" + GlobalEDate + " " + GlobalETime
                    //parent.f3.location.href="" + vURL;
 
                    //先選擇Item，為了要給查詢做判斷
                    window.iframeobject.document.getElementsByName("ass_type")[1].checked = true;
 
                    //查詢按鈕->直接置換頁面
                    iframeobject.location.href="../TubeManage/Assessment_List?starttime=" + GlobalSDate + " " + GlobalSTime + "&endtime=" + GlobalEDate + " " + GlobalETime;
 
                    //window.parent.f3.location.href = '?starttime=' +  GlobalSDate + ' ' + GlobalSTime + '&endtime=' + GlobalEDate + ' ' + GlobalETime;
 
                    //20190730  ../ 多爬一層 查詢按鍵 要加windows 要不然網頁無法顯示。
                    ABC();
                    //BAC();
 
                    //alert("成功按下查詢~!")
                    //alert(parent);
                    //alert(parent.f3);
                    //alert(parent.f3.location);
                    //alert(parent.f3.location.href);
                    //alert(windows.parent.f3.location.href);
 
 
                    //alert("owo3");
                    //alert(parent.f3.$('.1').fadeOut(0).value);
                    //alert("AVA2");
                    //alert(parent.f3.$('.1'));
                    //$('#parent').fadeOut('slow');
                    //alert($("input[class='.2']").val());
                    //alert("owo");
 
                    //parent.f3.$('.1').fadeOut(0);
                    //parent.f3.$('.0').fadeOut(0);
                    //parent.f3.$('.2').fadeIn(0);
 
                   //parent.f3.loading_change();
                   //window.location.href='Assessment_List?starttime=' + $('#start_date').val() + ' ' + $('#start_time').val() + '&endtime=' + $('#end_date').val() + ' ' + $('#end_time').val()
 
                    }
                }// Q07
 
           //}  //ItemCheck == 1
 
        } //Timeout_Count
        if (done==0){
            //不存在，就在等3秒鐘.
            //20191121
            // if (GlobalModuleID=="Q01"){
            // 	setTimeout('check_page();',10000);
            // }
            setTimeout('check_page();',1500);
            //setTimeout('check_page();',1500);  //調整500 太快 網頁來不及反應 會有問題
            Timeout_Count +=1;
            //alert("有近來done");
        }
 
}


function checkUser(vType){

	//找登入者帳號
	var userobj = parent.f2.document.all("Guiderid");

	if (userobj){
		//alert("有找到登入人員");
		//alert("登入帳號：" + userobj.value);


		//這裡之後為至Server取得此登入人員口說指令。


		//執行轉頁/查詢功能
		//先預設此病歷號00749684，之後由系統傳入
		changePage(userobj.value,vType);


		//第二種取得方式
		//----------------------------------
		//var userobj2 = parent.f2.document.all("leftMenuPanel")
		//if (userobj2){
		//	alert(userobj2.getAttribute("userid"));
		//	//setP(userobj2.getAttribute("userid"));
		//}

	} else {
		//alert("尚未登入");
		//setTimeout('checkUser(1);',3000);
	}
}

function changePage(userid,vType){

    //userid = 帳號 ex:nis168

    //alert("這裡是ChangePage, vType = " + vType);
	var data="C";
	var b;
	var modelID;
	var xmlObj1;
	var vCheck=0;

	var vURL="";
    var ptno="";

	var b = document.all("FuncSelect");
	//alert("1");
	//alert(b);
	//alert(b.selectedIndex);
	//alert(b.options[b.selectedIndex].value);
	var modelID = b.options[b.selectedIndex].value;
    //alert("2");
	//alert("1");
	if (vType==1){
	    //功能選取後觸發
		b = document.all("FuncSelect");
		modelID = b.options[b.selectedIndex].value;
		xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func");
		vCheck=1;
	} else if (vType==2) {
	    //查詢下拉選單選取後觸發
	    //alert("vType=2");
		b = document.all("FuncQuery");
		modelID = b.options[b.selectedIndex].value;
		xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func[@type='query' and @model_id='" + modelID + "']");
		vCheck=1;
	} else if (vType==3) {
        b = document.all("FuncSelect");
        modelID = Module_ID;
        //alert("ModuleID = " + modelID);
        xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func[@type='page' and @model_id='" + modelID + "']");
        vCheck=1;
	} else if (vType==4){
	  var input_element = document.getElementById('input_id');
      var text = input_element.value;
      if(text=="")
        alert("請輸入Module ID");
      else
        alert("您輸入的Module ID是: " + text);
		b = document.all("FuncSelect");
		modelID = text;
		xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func[@type='page' and @model_id='" + modelID + "']");
		vCheck=1;
	} else if (vType==5){
		//alert("a_1");
		//alert(userid);

		var xmlDoc_vv = parseXml2("xml/" + userid + "_vv.xml");
		//alert("xml/" + userid + "_vv.xml");
		//window.open("xml/" + userid + "_vv.xml","aaa");
		//alert("a_2@3210");
		//alert("xml/" + userid + "_vv.xml");
		//alert(xmlDoc_vv.xml);
		//alert("xmlDoc_vv.documentElement = ");
		//alert("xmlDoc_vv.documentElement = " + xmlDoc_vv.documentElement);
        //alert(xmlDoc_vv.documentElement);
        if (xmlDoc_vv){
            if(!xmlDoc_vv.documentElement){
                //alert("return false");
                return false;
            }
		} else {
		    return false;
		}

		//xmlObj_vv = xmlDoc_vv.documentElement.getElementsByTagName("func[@type='tag']");
		//alert("a_3_1");
		//20190902 peter 更改成Google也可以使用
		xmlObj_vv = xmlDoc_vv.documentElement.getElementsByTagName("func");

        //alert("xmlObj_vv.length = " + xmlObj_vv.length);

		//alert("a_3");
		if (xmlObj_vv.length>0){
		    //alert("有進來if迴圈");
		    for (var i=0;i<xmlObj_vv.length;i++){
		        if (xmlObj_vv.item(i).getAttribute("type") == 'tag'){
		            //alert("有偵測到tag2");
		            //alert(xmlObj_vv[0].getAttribute("model_id"));
		            //alert(xmlObj_vv[0].getAttribute("KeyWord"));
		            //alert(xmlObj_vv[0].getAttribute("PageName"));
		        }
		    }
		}
        	//alert("a_4");
		//Add by Ray 抓到就先刪除，看是否可以解決，第二次呼叫時，XML 沒有刪除的問題。
		//deleteXML("nis168");
        	deleteXML(userid);
		//alert("xmlObj_vv" + xmlObj_vv.length);
        	if (xmlObj_vv.length>0){

			var Module_ID = xmlObj_vv[0].getAttribute("model_id");
			var KeyWord = xmlObj_vv[0].getAttribute("KeyWord");
			var SDate = xmlObj_vv[0].getAttribute("SDate");
    		var EDate = xmlObj_vv[0].getAttribute("EDate");
    		var STime = xmlObj_vv[0].getAttribute("STime");
    		var ETime = xmlObj_vv[0].getAttribute("ETime");
    		var PageName = xmlObj_vv[0].getAttribute("PageName");
    		var Func = xmlObj_vv[0].getAttribute("Func");
			//抓取fee_no
			var Fee_no = "";
			//var Ptno_no = "";
			var Fee_no = xmlObj_vv[0].getAttribute("fee_no");//I033xxx
            GlobalFee_no = Fee_no;
			//Add by Ray 2019/10/7
			var Ptno_no = xmlObj_vv[0].getAttribute("ptno");//"00749684";
			//var Ptno_no = "00749684";
			//alert("Fee_no = " + Fee_no);
			//alert("Ptno_no = " + Ptno_no);
			//ptno = Fee_no;//I033xxx

        		//peter 20191004 修正網頁BUG
        		if (xmlObj_vv[0].getAttribute("SDate")) {
            			//alert("xmlObj_vv[0].getAttribute(SDate) = " + xmlObj_vv[0].getAttribute("SDate"));
        		}else{
            			//alert("xmlObj_vv[0].getAttribute(SDate) = 沒有參數");
            			var dt = new Date();
            			var d = dt.getMonth()+1
            			//alert("今天日期 = "  + dt.getFullYear() + "/" + d + "/" + dt.getDate() + "\r\n" 
            			//    + "今天時間 = " + dt.getHours() + ":" + dt.getMinutes());

           			 SDate = dt.getFullYear() + "/" + d + "/" + dt.getDate();
            			EDate = dt.getFullYear() + "/" + d + "/" + dt.getDate();

            			STime = "00:00";
            			ETime = dt.getHours() + ":" + dt.getMinutes();
            			//alert("dt.getHours() = " + dt.getHours());
            			//alert("dt.getMinutes() = " + dt.getMinutes());
            			//alert("dt.getMonth() = " + d);
            			//alert("dt.getDate() = " + dt.getDate());

        		}

        // alert("xmlObj_vv[0].getAttribute(SDate) = " + xmlObj_vv[0].getAttribute("SDate");
        // alert("xmlObj_vv[0].getAttribute(EDate) = " + xmlObj_vv[0].getAttribute("EDate"));
        // alert("xmlObj_vv[0].getAttribute(STime) = " + xmlObj_vv[0].getAttribute("STime"));
        // alert("xmlObj_vv[0].getAttribute(ETime) = " + xmlObj_vv[0].getAttribute("ETime"));   

		b = document.all("FuncSelect");  //b找下拉選單

		modelID = Module_ID;
		GlobalKeyWord = KeyWord;
		GlobalSDate = SDate;
		GlobalEDate = EDate;
		GlobalSTime = STime;
		GlobalETime = ETime;
		GlobalPageName = PageName;
		GlobalFunc = Func;
		//alert("GlobalPageName = " + GlobalPageName);
		//alert("ModuleID = " + modelID);
		//alert("GlobalKeyWord = " + GlobalKeyWord);
		//alert("GlobalSDate = " + GlobalSDate);
		//alert("GlobalEDate = " + GlobalEDate);
		//alert("GlobalSTime = " + GlobalSTime);
		//alert("GlobalETime = " + GlobalETime);
		xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func");
		vCheck=1;
		//alert("c");
	
	//Add by Ray
	//=========================

	for (var i=0;i<xmlObj1.length;i++){
		//if (xmlObj1.item(i).getAttribute("model_id") == modelID){
		//	vURL = xmlObj1.item(i).getAttribute("module");
        //    alert("vURL = " + vURL);
		//}
		//document.getElementById("Test").value)

		//20190805 查詢pagename對應的網址
		if(xmlDoc.documentElement.getElementsByTagName("func")[i].firstChild.nodeValue == GlobalPageName){
		//alert("d");
			if(GlobalFunc == xmlObj1.item(i).getAttribute("type")){
			    vURL = xmlObj1.item(i).getAttribute("module");
			    GlobalFunc = ""; //初始化避免在執行一次
		    }else if(GlobalFunc == xmlObj1.item(i).getAttribute("type")){
		        vURL = xmlObj1.item(i).getAttribute("module");
		        GlobalFunc = ""; //初始化避免在執行一次
		    }
		}

		//alert("每個的item文字 = " + xmlDoc.documentElement.getElementsByTagName("func")[i].firstChild.nodeValue);
		//alert("e");
	} //for


        //確認是否為開啟頁面
        var vContent_voice = "";
        var xmlDoc_voice = parseXml("voicecontrol_vv.xml");
        xmlObj_voice = xmlDoc_voice.documentElement.getElementsByTagName("func");
        for (var i=0;i<xmlObj_voice.length;i++){
            if (xmlObj_voice.item(i).getAttribute("area") == 1){
                //vContent_voice = xmlObj_voice.item(i).textContent;
                //vContent_voice = xmlObj_voice.item(i).innerText;
                vContent_voice = xmlObj_voice.item(i).textContent;
                if (!vContent_voice){
                    vContent_voice = xmlObj_voice.item(i).text;
                }
                // alert("GlobalArea12345 = " + GlobalArea);
                // alert("vContent_voice54321 = " + vContent_voice);
                // alert("GlobalPageName = " + GlobalPageName);
                if (GlobalPageName == vContent_voice) {
                    GlobalArea = 1;
                    // alert("GlobalArea2 = " + GlobalArea);
                }
            }
        }

        //alert("GlobalArea3 = " + GlobalArea);
        if(GlobalArea == 0){
            GlobalArea = 2; //為偵測到首頁帶入2
        }

        //alert("GlobalArea4 = " + GlobalArea);

        } //if (xmlObj_vv.length>0)
        else{
            //alert("bb");
        }
            //alert("cc");
	} //else if (vType==5)
	//alert("vType:" + vType);
  	if (vCheck==1){
    	//找到XML內有Tag



	   if (vType !=5){
            		vURL = xmlObj1(0).getAttribute("module");
	    }
           
	    	

            if ((Fee_no == null || Fee_no =="") && (Ptno_no == null || Ptno_no =="")) {
                //alert("Fee_no與Ptno_no都沒有");
                JNP(modelID, userid, vType, vURL);                
            }
            // alert("a");
            // if("a" == "a"){
            // 	alert("a當然等於a");
            // }
            // alert("b");
            // if("a" != "b"){
            // 	alert("a當然不等於b");
            // }else{
            // 	alert("87");
            // }
            //動態查詢網頁 避免重複執行
            var pp = vURL;
            var vURL_Array = [];
           	var vURL_Array_Sum = "";
            var vURL_Array_length = 0;
            var j = 0;
            var location_URL = parent.f2.document.all("mainContent").contentWindow.location.href;
            var location_URL_Array = [];
            var location_URL_Array_Sum = "";
            var location_URL_Array_length = 0;
		    pp = vURL.substring(2, vURL.length); // 獲取子字串。
		    //alert("要比對的字串 = " + pp + "\nvURL.substr(7, 8) = " + vURL.substr(7, 8));
		    for(i=0;i<pp.length;i++){
		    	if(pp.substring(i, i+1) == "?"){//問號後面不儲存(包含問號)
		    		i = pp.length;
		    		//vURL_Array_Sum = vURL_Array_Sum.substring(0,vURL_Array_Sum.length);
		    		//vURL_Array[i] = "";
		    		//alert("已偵測到? i = " + i);
		    		//alert("vURL_Array字串儲存結束 = " +vURL_Array_Sum);
		    		//vURL_Array_length = i-1;
		    		//alert("vURL_Array_length = " + vURL_Array_length);
		    	}else{
			    	vURL_Array[i] = pp.substring(i, i+1);
			    	vURL_Array_Sum += vURL_Array[i];
			    	vURL_Array_length = i;
		    	}
				
		    }
		    //alert("vURL_Array_length = " + vURL_Array_length + "\nvURL_Array_Sum = " + vURL_Array_Sum);
		    for(i=0;i<location_URL.length;i++){
		    	if(location_URL_Array[i] == "?"){
		    		i = location_URL.length;
		    		//location_URL_Array_length = i+1;
		    		//alert("location_URL_Array_Sum字串儲存結束 = " + location_URL_Array_Sum);
		    	}else{
			    	location_URL_Array[i] = location_URL.substring(i, i+1);
			    	location_URL_Array_Sum += location_URL_Array[i];
			    	location_URL_Array_length = i;
			    	//alert("location_URL_Array[" + i + "] = " + location_URL_Array[i])
		    	}
		    	//如果有問號需要多加1
		    }

		    //alert("vURL_Array字串儲存結束 = " + vURL_Array_Sum + "\n" + "location_URL_Array_Sum字串儲存結束 = " + location_URL_Array_Sum);
		    //alert("location_URL_Array_length = " + location_URL_Array_length);
		    for(i=0;i<location_URL_Array_length;i++){
		    	if(location_URL_Array[i] == vURL_Array[j]){
		    		//alert("location_URL = " + location_URL + "\n" + "pp = " + pp + "\nlocation_URL_Array[" + i + "] = " + location_URL_Array[i] + "\nvURL_Array[" + j + "] = " + vURL_Array[j] + "\nlocation_URL_Array_length = " + location_URL_Array_length + "\nvURL_Array_length = " + vURL_Array_length + "\nj = " + j);
		    		j+=1;
		    		if(j == vURL_Array_length){
		    			PCheck = true;
		    			//alert("辨識已完成~!是在同一頁~!");
		    		}
		    	}else{
		    		j=0;
		    	}
		    }

            //alert("目前的網頁 = " + parent.f2.document.all("mainContent").contentWindow.location.href
        	//  + "\n" + "vURL = " + vURL + "\n要比對的字串 = " + pp);

        	//var feeno = "";
        	//alert("a");
        	//iframeobject = parent.f2.document.all("mainContent").contentWindow;
        	//alert("b");
        	// alert(parent.f2); //[object Window]
        	// alert(parent.f2.document);//[object HTMLDocument]
        	// alert(parent.f2.document.all("mainContent"));//[object HTMLIFrameElement]
        	// alert(parent.f2.document.all("mainContent").contentWindow);//[object Window]
        	// alert(iframeobject.document);//[object HTMLDocument]
        	// alert(iframeobject.document.all("feeno"));//undefined
			//alert(parent.f2.document.all("patinfo"));
 			//alert(parent.f2.document.all("patinfo").innerHTML);
			//alert(parent.f2.document.all("patinfo").childNodes);
			//alert(parent.f2.document.all("patinfo").childNodes[1].getAttribute("feeno"));
			//alert("a");
			//alert(parent.f2.document.all("patinfo").innerHTML);
			//for (var i = 1; i < 10; i++) {
				//alert("parent.f2.document.all(patinfo).childNodes["+i+"].getAttribute(feeno) = " + parent.f2.document.all("patinfo").childNodes[i].getAttribute("feeno"));
			//}
			//alert("b");
			if(parent.f2.document.all("patinfo").childNodes[1].getAttribute("feeno") == ""){
				//alert("目前沒有Fee_no哦~! = ");
				FCheck = false;
			}else{
				//alert("目前網頁的Fee_no = " + parent.f2.document.all("patinfo").childNodes[1].getAttribute("feeno"));
				//alert("目前指令的Fee_no = " + GlobalFee_no);
				if(parent.f2.document.all("patinfo").childNodes[1].getAttribute("feeno") == GlobalFee_no){
					//alert("兩個Fee_no相同");
					FCheck = true;
				}else{
					//alert("兩個Fee_no不相同");
					FCheck = false;
				}
			}
			//alert(parent.f2.document.all("patinfo").table.getAttribute("feeno"));
			//alert(parent.f2.document.all("patinfo").childNodes[0].getAttribute("feeno"));
			// for (var i = 0 ;i< parent.f2.document.all("patinfo").childNodes.length;i++){
			// 	alert(parent.f2.document.all("patinfo").childNodes[i].innerHTML);


			// }
			//(0).getAttribute("feeno")
 			//firstChild
        	// if(iframeobject.document.all("feeno")){
        	// 	//null -> undefined
        	// 	alert("feeno = undefined");
        	// }else{
        	// 	feeno = iframeobject.document.all("feeno").value;
        	// 	alert("當前網頁的feeno = " + feeno + "\n跳轉的GlobalFee_no = " + GlobalFee_no);
        	// 	if(feeno == GlobalFee_no){
        	// 		FCheck = true;
        	// 	}
        	// }

        	// if(FNum == ""){
        	// 	FCheck = false;
        	// }
        	// if(FNum == GlobalFee_no){
        	// 	//alert("相同的Fee_no");
        	// 	FCheck = true;
        	// }else{
        	// 	FCheck = false;
        	// 	//alert("上一個Fee_no = " + FNum + "\n這次的Fee_no = " + GlobalFee_no);
        	// }

        	// FNum = GlobalFee_no;
        	// if(iframeobject.document.all("feeno")){
        	// 	alert("iframeobject.document.all(feeno)有東西");
        	// }else{
        	// 	feeno = iframeobject.document.all("feeno").value;
        	// 	alert("當前網頁的feeno = " + feeno + "\n跳轉的GlobalFee_no = " + GlobalFee_no);
        	// }
        	//alert("c");

        		//alert("PCheck = " + PCheck + " FCheck = " + FCheck);

	                        //網頁的記憶性
							//parent.f2.ReloadModule(modelID);
							if(modelID == "Q01"){
								//TPR - > 生命徵象
								RealModelID = "M14";
							}
							if(modelID == "Q02"){
								//護理紀錄
								RealModelID = "M03";
							}
							if(modelID == "Q03"){
								//文字醫囑 -> 醫囑
								RealModelID = "M12";
							}
							if(modelID == "Q04"){
								//藥品醫囑 -> 醫囑
								RealModelID = "M12";
							}
							if(modelID == "Q05"){
								//生命徵象
								RealModelID = "M14";
							}
							if(modelID == "Q06"){
								//給藥作業
								RealModelID = "M01";
							}
							if(modelID == "Q07"){
								//給藥作業
								RealModelID = "M16";
							}
                            if(modelID != "Q01" && modelID != "Q02" && modelID != "Q03" && modelID != "Q04" && modelID != "Q05" && modelID != "Q06" && modelID != "Q07"){
                                RealModelID = modelID;
                            }

							  //網頁的記憶性
							  //alert("a");
							if(!PCheck || !FCheck){
								//如果不是相同頁面才需要儲存，如果是相同頁面儲存就會有問題。
							  parent.f2.ReloadModule(RealModelID);
							}
							  //alert("b");
							  //alert(parent.f2.document);
							  //alert(parent.f2.document.innerHTML);
							  //alert(parent.f2.document.all("model_id").value);
							  //parent.f2.document.all("model_id")=RealModelID;
							  //alert("c");

	    	if(!PCheck || !FCheck){//如果與上次跳轉網址一樣就不執行跳轉 或者是Fee不同
	    		//alert("!PCheck || !FCheck");
	 			$.ajax({
	                                 url: "../Main/SetPatient", timeout: 5000, type: "post",
	                                        data: "fee_no=" + Fee_no,
	                                        success: function () {

                            //Peter 20191210關閉
							//parent.f2.$('#leftFuncName').click();

							//取得病人資訊，並顯示 (左邊清單)
	                                           	parent.f2.GetPtInfoArea();
							// 如果有點選病人，讀取跑馬燈
	                        //alert("如果有點選病人，讀取跑馬燈");
	                                           	parent.f2.readMqList();

	                        //alert("2");
	                                        },
	                                        complete: function () {
							//alert("OK");
	                        //alert("Fee_no = " + Fee_no);

							//alert("modelID = " + modelID + " RealModelID = " + RealModelID);
							//alert("vURL = " + vURL);
							//alert("modelID = " + modelID);
							
							//alert(parent.f2.ReloadModule(modelID));

							//alert(parent.f2.document.CurrentModule);
							//parent.f2.CurrentModule =modelID;
							//alert(1);

							//alert(2);
							//alert("parent.f2.document.all(model_id).value = " + parent.f2.document.all("model_id").value)
							//alert("parent.f2.document.all(model_id) = " = parent.f2.document.all("model_id"));
	                        //parent.f2.reSettingIframe(vURL, "ABC");
	                        //alert("a");

	                        //marked by Ray 2019/11/28
	                        //alert(1);
	                        parent.f2.show_ptinfo(vURL,"護理資訊系統");
	                        //alert(2);
	                        //alert("b");三天內臨時醫囑
	                        
	                       
	                        //alert("reSettingIframe vURL = " + vURL);
	                        
	                        aModelID = modelID;
	                        
	                        aUserid = userid;
	                        
	                        avType = vType;
	                        
	                        avURL = vURL;
	                        
	                        //alert(3);
							JNP(modelID, userid, vType, vURL);
							//alert(4);
						}

				})

			  }else{ //如果與上次跳轉網址一樣就執行Query參數選取
			  	//alert("目前網頁與上個網頁相同");
			  	//PCheck = true;
			  	if(modelID=="Q01" || modelID=="Q02" || modelID=="Q03" || modelID=="Q04" || modelID=="Q05" || modelID=="Q06" || modelID=="Q07"){
             	GlobalModuleID = modelID;
             	//alert("這裡是查詢頁面 GlobalModuleID = " + GlobalModuleID);
             	Timeout_Count=0; //peter 20190927 如果Timeout_Count>1不成立，則不會item選擇
             	check_page();
             	Item_Check1 = 1; //只執行一次 查詢頁面資料

         		}
			 }

			//PURL = vURL;

		
        }
}


function  deleteXML(userid){

                            var t = new Date(); //避免參數一樣，導致瀏覽器不動作(快取問題)
                            //alert("刪除1");
                            //window.open("aspx_test.aspx?func=delete&userid=" + userid + "&t="+t,"");
                            $.ajax({
                                            url: "aspx_test.aspx", timeout: 100, type: "post",
                                            data: "func=delete&userid=" + userid + "&t="+t,
                                success: function () {
                                    //alert("刪除2");
                                    //alert("success");timeout=5000 最多等五秒
                                },
                                complete: function () {
                                }
                            });

}

//alert("good");

//等3秒後，執行checkUser(1)
//setTimeout('checkUser(1);',3000);

function backtoHome(){
	//隱藏右邊
	parent.document.all("mainframe").setAttribute("cols","0%,100%,0%");
}

function changeURL(model_id){

}



function parseXml(fileName){


	try{//Internet Explorer

		xmlDoc=new ActiveXObject("Microsoft.XMLDOM");

		xmlDoc.async = "false";

		//加载 XML文档,获取XML文档对象

		xmlDoc.load(fileName);

	}
	catch(e){

		//Firefox, Mozilla, Opera, etc.

		try{

			xmlDoc=document.implementation.createDocument("","",null);

			xmlDoc.async = "false";

			//加载 XML文档,获取XML文档对象

			xmlDoc.load(fileName);

		}catch(e){


     			try{//Google Chrome
				var xmlhttp=new window.XMLHttpRequest();

				xmlhttp.open("get",fileName,false);

				xmlhttp.send(null);

				xmlDoc=xmlhttp.responseXML;


			}catch(e){
				alert("您的瀏覽器不能正常載入文件。請切換到兼容模式，或者更換瀏覽器");

			}

		}

	}

	return xmlDoc;
}
//
function parseXml2(fileName){

	try{//Internet Explorer

		xmlDoc_vv=new ActiveXObject("Microsoft.XMLDOM");

		xmlDoc_vv.async = "false";

		//加载 XML文档,获取XML文档对象

		xmlDoc_vv.load(fileName);

        if (!xmlDoc_vv) {
            alert("不能創建XMLHttpRequest對象");
        }

	}
	catch(e){

		//Firefox, Mozilla, Opera, etc.

		try{

			xmlDoc_vv=document.implementation.createDocument("","",null);

			xmlDoc_vv.async = "false";

			//加载 XML文档,获取XML文档对象

			xmlDoc_vv.load(fileName);

		}catch(e){


     			try{//Google Chrome
				var xmlhttp=new window.XMLHttpRequest();

				xmlhttp.open("get",fileName,false);

				xmlhttp.send(null);

				xmlDoc_vv=xmlhttp.responseXML;


			}catch(e){



				alert("您的瀏覽器不能正常載入文件。請切換到兼容模式，或者更換瀏覽器");

			}

		}

	}

	return xmlDoc_vv;

}


</script>

<body>

<center>
    語音模擬Demo
</center>


<br><br>
<fieldset>
    <table>
        <tr><td>頁面快轉</td></tr>
        <tr><td><span id="pageselect"></span></td></tr>
        <tr><td><input type="button" onclick="checkUser(1);" value="GO"></td></tr>
    </table>
</fieldset>


<br><br>
<fieldset>
    <table>
        <tr><td>語音查詢</td></tr>
        <tr><td><span id="queryselect"></span></td></tr>
        <tr><td><input type="button" onclick="checkUser(2);" value="GO"></td></tr>
    </table>
</fieldset>

<br><br>
自動語音命令測試
<br>
<input type="button" onclick="checkUser(3);" value="前往">

<br><br>
手動語音命令測試
<br><input type="text" value="" id='input_id'><br>
<input type="button" onclick="checkUser(4);" value="前往">

<br><br><br><br>
<input type="button" onclick="backtoHome();" value="回首頁">


<!--//"http://demo.mayaminer.com.tw/NIS_ECK/Main/SetPatient?fee_no=I033097  00749684"-->

</body>
<script>

//var xmlDoc_vv = parseXml2("voicecontrol_vv.xml");
//var Module_ID = "";
//var vstr = "<select name='FuncSelect'>";
//20190902改成Google可以使用
//xmlObj_vv = xmlDoc_vv.documentElement.getElementsByTagName("func[@type='tag']");
//xmlObj_vv = xmlDoc_vv.documentElement.getElementsByTagName("func");
//alert(xmlObj_vv.length);
//if (xmlObj_vv.item(i).getAttribute("type") == "page"){
//    //Module_ID = xmlObj_vv[0].getAttribute("model_id")
//    vstr += "<option value='" + xmlObj_vv[i].getAttribute("model_id") + "'>" + xmlObj_vv[i].text + "</option>" ;
//}
//alert(Module_ID)
//alert(xmlObj_vv[0].getAttribute("model_id"))//
//var txt = xmlObj_vv[0].getAttribute("model_id") //txt=M39

//顯示[頁面快轉]的下拉選單
var vContent = "";
var xmlDoc = parseXml("voicecontrol_vv.xml");
//20190902改成Google可以使用
xmlObj = xmlDoc.documentElement.getElementsByTagName("func");
//xmlObj = xmlDoc.documentElement.getElementsByTagName("func[@type='page']");

//alert(xmlObj.length);
var vstr = "<select name='FuncSelect'>";
for (var i=0;i<xmlObj.length;i++){
	//alert(xmlObj.item[i]);
	if (xmlObj.item(i).getAttribute("type") == "page"){
	    vContent = xmlObj.item(i).textContent;
	    vstr += "<option value='" + xmlObj[i].getAttribute("model_id") + "'>" + vContent + "</option>" ;
	}
}
vstr += "</select>";
//alert(vstr);
document.all("pageselect").innerHTML = vstr;


//顯示[語音查詢]的下拉選單
//xmlObj = xmlDoc.documentElement.getElementsByTagName("func[@type='query']");
xmlObj = xmlDoc.documentElement.getElementsByTagName("func");
var vstr2 = "<select name='FuncQuery'>";
for (var i=0;i<xmlObj.length;i++){
    if (xmlObj.item(i).getAttribute("type") == "query"){
	    vContent = xmlObj.item(i).textContent;
	    vstr2 += "<option value='" + xmlObj[i].getAttribute("model_id") + "'>" + vContent + "</option>" ;
	}

}
vstr2 += "</select>";
//alert(vstr2);
document.all("queryselect").innerHTML = vstr2;
</script>
<input type="button" name="按查詢" onclick="parent.f3.reload_div();">
</html>


<input type="button" onclick="alert(' ')" value="TEST1">
<input type="button" onclick="vv();" value="TEST1_innerHTML">
<input type="button" onclick="alert('PPAP');" value="TEST2">
<input type="button" onclick='alert(parent.f3.document);' value="TEST3">
<input type="button" onclick='alert(document.getElementsByClassName("div").innerHTML);' value="TEST4">
<input type="button" onclick='alert(document.getElementsByClassName("div"));' value="TEST5">
<input type="button" onclick='alert(parent.f3.getElementsByClassName("dataHeader")[0].innerHTML);' value="TEST6">
<input type="button" onclick='alert(parent.f3);' value="TEST7">
<input type="button" onclick='alert(parent);' value="TEST8">
<input type="button" onclick='alert(document);' value="TEST9">
<input type="button" onclick='alert(document.getElementsByClassName("funcArea")[0].innerHTML);' value="TEST10">
<input type="button" onclick='alert(window.parent.document.getElementsByClassName("funcArea")[0].innerHTML);' value="TEST11">
<input type="button" onclick='ABC();' value="TEST12">
<input type="button" onclick='BAC();' value="TEST13">
<input type="button" onclick='nurse();' value="護理紀錄查詢">

<script>
        function ABC(){

       iframeobject = parent.f2.document.all("mainContent").contentWindow;

       //Peter 20191210 IE8不支援getElementsByClassName，所以使用querySelectorAll
       if(window.iframeobject.document.getElementsByName("ass_type")[0].checked){

         window.iframeobject.document.querySelectorAll("div.dataHeader")[0].parentNode.parentNode.style.display="none";
         //alert("C");
         window.iframeobject.document.querySelectorAll("div.dataHeader")[1].parentNode.parentNode.style.display="none";
         window.iframeobject.document.querySelectorAll("div.dataHeader")[2].parentNode.parentNode.style.display="none";

 
        if(GlobalKeyWord == "動靜脈類管路"){
            window.iframeobject.document.querySelectorAll("div.dataHeader")[0].parentNode.parentNode.style.display="";
            window.iframeobject.document.getElementsByName("ass_type")[0].checked = true;
        }else if(GlobalKeyWord == "非縫線類管路"){
            window.iframeobject.document.querySelectorAll("div.dataHeader")[1].parentNode.parentNode.style.display="";
            window.iframeobject.document.getElementsByName("ass_type")[1].checked = true;
        }else if(GlobalKeyWord == "有縫線類管路"){
            window.iframeobject.document.querySelectorAll("div.dataHeader")[2].parentNode.parentNode.style.display="";
            window.iframeobject.document.getElementsByName("ass_type")[2].checked = true;
        }else{
            window.iframeobject.document.querySelectorAll("div.dataHeader")[0].parentNode.parentNode.style.display="";
            window.iframeobject.document.getElementsByName("ass_type")[0].checked = true;
        }
 
        //初始化為0，避免重複執行
        Global_delete();
 
    }else{
            setTimeout('ABC();',1500);
        }
    }

//解決IE8無法使用getElementsByClassName的功能 20191209
    //var  divs = getClassNames('tabs_div' , 'div');
    function getClassNames(classStr,tagName){
        alert(classStr,tagName);
          if (window.iframeobject.document.getElementsByClassName) {
            alert(1);
                return window.iframeobject.document.getElementsByClassName(classStr)
                alert(2);
          }else {
            alert(3);
                var nodes = window.iframeobject.document.getElementsByTagName(tagName),ret = [];
                alert(4);         
                for(i = 0; i < nodes.length; i++) {
             if(hasClass(nodes[i],classStr)){
                    ret.push(nodes[i])
                    alert(5);
             }
          }
          alert(6);
          return ret;
           }
    }
    function hasClass(tagStr,classStr){
         var arr=tagStr.className.split(/\s+/ );  //這個正則表示式是因為class可以有多個,判斷是否包含
         for (var i=0;i<arr.length;i++){
                if (arr[i]==classStr){
                      return true ;
                }
         }
         return false ;
    }
//

    function BAC(){
        //alert(window.parent.f3.document.getElementsByName("ass_type")[0].parentNode.innerHTML);
        window.parent.f3.document.getElementsByName("ass_type")[2].checked = true;
    }
 
    //給藥作業
    function select_item_vv(){
        
        iframeobject = parent.f2.document.all("mainContent").contentWindow;
        //alert("bbb");
        //peter20191112
        iframeobject.document.all("ExecFlag").value = "quiryInterval";
        //parent.f2.document.all("ExecFlag").value = "quiryInterval";
        //alert("ccc");
        //peter20191112
        window.iframeobject.document.getElementsByTagName("form")[0].submit(); //按下查詢
        //window.parent.f2.document.getElementsByTagName("form")[0].submit(); //按下查詢
        //alert("select_item_vv 有被執行到2");
 
        select_item();
 
    }
    //select
    function select_item(){
        //alert("這裡是查詢Q06");
        iframeobject = parent.f2.document.all("mainContent").contentWindow;
        //alert("select_item有被選擇到")
        //按下查詢之後檢查是否載入網頁已完成
        if(iframeobject.document.all("select_all_order").checked){
 
        //alert("select_item有被選擇到, select_all_order有打勾勾")
        //alert("GlobalKeyWord_drug = " + GlobalKeyWord_drug)
        //alert("已經近來Select_Item");
        //alert("這裡是查詢Q06, 有近來if GlobalKeyWord_drug = " + GlobalKeyWord_drug);
        if(GlobalKeyWord_drug == "全部"){
            iframeobject.document.all("select_all_order").checked = true;
            //alert("有執行全部");
        }else if(GlobalKeyWord_drug == "已DC"){
            iframeobject.document.all("select_del_order").checked = true;
            //alert("有執行已DC");
        }else if(GlobalKeyWord_drug == "未DC"){
            iframeobject.document.all("select_act_order").checked = true;
            //alert("有執行未DC");
        }else{
            iframeobject.document.all("select_all_order").checked = true;
        }
 
        GlobalKeyWord_drug = "";
        iframeobject.find_medcode(); //篩選
 
        //初始化為0，避免重複執行
        Global_delete();
 
        }
 
        else{
            setTimeout('select_item();',1500);
        }
    }

    function nurse(){
        alert(window.parent.f3.document.getElementById("form1").parentNode.innerHTML);
    }

    function JNP(modelID, userid, vType, vURL){  //Jump No Patient
    	
        //alert("modelID = " + modelID + ", userid = " + userid + ", vType = " + vType + ", vURL = " + vURL);
    	//parent.f2.ReloadModule("M01");
        if (vType==1){
        	//alert("i");
            //語音跳轉
            //主頁面跳轉過去
			//Modified by Ray 2019/10/7
            //parent.f2.ReloadModule(modelID);
	    	parent.f2.reSettingIframe(vURL, "ABC");
            //alert("1");
        } else {
            //alert("2");
        }

        //把右邊的網址換到[每日評估]
        //parent.f3.location.href="../DailyBodyAssessment/Index";

        //parent.f2.location.href="../Main/Index";
        //parent.f2.location.href="../CommonMedication/Index?url=D#";
        //alert(parent.f2.document.all("mainContent").contentWindow);

        
        parent.f2.reSettingIframe(vURL, "ABC");
        

        //alert("1");
        parent.f3.location.href="" + vURL;  //是整頁換掉
        //alert("2");
        //parent.f2.$('#leftFuncName').click();
        //取得病人資訊，並顯示 (左邊清單)
        //parent.f2.GetPtInfoArea();
        // 如果有點選病人，讀取跑馬燈
        //parent.f2.readMqList();
        //parent.f2.ReloadModule(modelID);
        //parent.f2.reSettingIframe(vURL, "ABC")

            //alert("3");
            //alert("準備跳轉網頁，各為抓緊囉~!");
            //alert("GlobalArea = " + GlobalArea);
        //隱藏中間
        //alert(parent.document.all("mainframe").getAttribute("cols"));
        if (GlobalArea == 2) { //如果GlobalArea==2 則不是跳回首頁 如果是1則是跳回首頁<隱藏B>
            //alert("GlobalArea = " + GlobalArea);
            //parent.document.all("mainframe").setAttribute("cols","0%,0%,100%");
            parent.document.all("mainframe").setAttribute("cols","0%,100%,0%");
        }
        if (GlobalArea == 1) {
            //alert("GlobalArea = " + GlobalArea);
            parent.document.all("mainframe").setAttribute("cols","0%,100%,0%");
            //使用完以後就清除
            GlobalArea = 0;
        }


       if(modelID=="Q01" || modelID=="Q02" || modelID=="Q03" || modelID=="Q04" || modelID=="Q05" || modelID=="Q06" || modelID=="Q07"){
            GlobalModuleID = modelID;
            //alert("這裡是查詢頁面 GlobalModuleID = " + GlobalModuleID);
            Timeout_Count=0; //peter 20190927 如果Timeout_Count>1不成立，則不會item選擇
            check_page();
            Item_Check1 = 1; //只執行一次 查詢頁面資料

            //alert("5");
            //alert("呼叫check_page~!");
        }

//Peter 20191210開啟
setTimeout(function() {
          //alert(3);
          parent.f2.document.getElementById("leftFuncName").click();
      }, 3000);
        //20190830
         //deleteXML(userid);
         //Global_delete();
         //alert("6");
        //deleteXML("nis168");
        //刪除xml peter
    }
</script>
