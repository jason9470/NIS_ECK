<!-- javascript -->
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jquery-1.9.1.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jquery.mayaminer.util.min.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jQueryUI/jquery-ui.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jQueryUI/jquery-ui-timepicker-addon.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jQueryUI/jquery-ui-sliderAccess.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jquery.switchButton.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/JSTool.js?20190401161123"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/mayaminer.jstool.datetime.min.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/raphael-min.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jquery.imgareaselect.min.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jquery.blockUI.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/moment.js?20190401161123"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/jquery.jqGrid.js"></script>
<script type="text/javascript" src="../../NIS_VOICE/Scripts/i18n/grid.locale-tw.js"></script>

<script>
var GlobalModuleID="";

var Timeout_Count = 0;

var Item_Check1 = 0;

var GlobalKeyWord = "";

var GlobalKeyWord_drug = "";

var GlobalSDate = "";

var GlobalEDate = "";

var GlobalSTime = "";

var GlobalETime = "";

var GlobalPageName = "";

var GlobalFunc = "";
//alert("BO");
pp();

function pp(){
	//alert("check!");
	//alert("無限迴圈");
	checkUser(5);
	setTimeout('pp();',5000);
}

//清除全域變數的值
function Global_delete(){
        GlobalModuleID = "";
        GlobalKeyWord = "";
        GlobalSDate = "";
        GlobalEDate = "";
        GlobalSTime = "";
        GlobalETime = "";
        GlobalPageName = "";
        GlobalFunc = "";
        //alert("清除參數~!"+GlobalModuleID+GlobalKeyWord+GlobalSDate+GlobalEDate+GlobalSTime+GlobalETime);
}

function check_page(){
    //檢查查詢頁面的start_date參數是否存在
        var done=0;
        if (Timeout_Count>1){
                //alert("有近來Timeout_Count");
           if (Item_Check1 == 1){
                if (GlobalModuleID=="Q03"){

                //if(parent.f3.document.all("btn_sign").disabled){
                //    alert("這裡是文字醫囑，Button被Disabled");
                //}
                    //文字醫囑 item 選擇 (OK)
                    //20190802 如果已偵測到長期醫囑item有被觸發，則是代表網頁Loading完成，則進行item選擇。
                    if(parent.f3.document.all("showR").checked && parent.f3.document.all("btn_sign").disabled){

	                   if(GlobalKeyWord == "長期醫囑"){
                             parent.f3.document.all("showR").checked = true;
    　                       parent.f3.showordertype('R');
                        }else if(GlobalKeyWord == "三天內臨時醫囑"){
                             parent.f3.document.all("showS").checked = true;
    　                       parent.f3.showordertype('S');
                        }else if(GlobalKeyWord == "DC醫囑"){
                             parent.f3.document.all("showDC").checked = true;
    　                       parent.f3.showordertype('DC');
                        }else if(GlobalKeyWord == "全部臨時醫囑"){
                             parent.f3.document.all("showS_all").checked = true;
                             parent.f3.ckAllS();
                        }else if(GlobalKeyWord == "出院醫囑"){
                             parent.f3.document.all("show_leave").checked = true;
                             parent.f3.showordertype('D');
                        }else if(GlobalKeyWord == "全部醫囑"){
                             parent.f3.document.all("show_all").checked = true;
                             parent.f3.showordertype('all');
                        }

                        Item_Check1 = 0;
                        //初始化為0，避免重複執行
                        Timeout_Count=0;
                        done=1;
                        Global_delete();

	                }

                }
                if (GlobalModuleID=="Q04"){
                   //藥品醫囑 item 選擇
                   //20190802 如果已偵測到長期醫囑item有被觸發，則是代表網頁Loading完成，則進行item選擇。
                   if(parent.f3.document.all("showR").checked && parent.f3.document.all("btn_excute").disabled){
                       if(GlobalKeyWord == "長期醫囑"){
                             parent.f3.document.all("showR").checked = true;
    　                       parent.f3.showordertype('R');
                        }else if(GlobalKeyWord == "臨時醫囑"){
                             parent.f3.document.all("showS").checked = true;
    　                       parent.f3.showordertype('S');
                        }else if(GlobalKeyWord == "DC醫囑"){
                             parent.f3.document.all("showD").checked = true;
    　                       parent.f3.showordertype('D');
                        }
                            Item_Check1 = 0;
                            //初始化為0，避免重複執行
                            Timeout_Count=0;
                            done=1;
                            Global_delete();
                   }
                }  //Q04


                if (GlobalModuleID=="Q05"){
                    if (parent.f3.document.all("stDate")){
                    //存在，就填入值
                    //alert("有近來stDate");
                    parent.f3.document.all("stDate").value= GlobalSDate;
                    parent.f3.document.all("edDate").value= GlobalEDate;
                    parent.f3.document.all("stTime").value= GlobalSTime;
                    parent.f3.document.all("edTime").value= GlobalETime;
                    //生命徵象(OK) 無資料，尚未驗證
                    //alert("GlobalModuleID=Q05")
                    //parent.f3.loading_change();
                    //換整頁(location.href) 20190729
                    loading_change();
                    //parent.f3 = 'TubeManage/Assessment_List?starttime=' +  GlobalSDate + ' ' + GlobalSTime + '&endtime=' + GlobalEDate + ' ' + GlobalETime;
                    //window.parent.open_cover();
                    //初始化為0，避免重複執行
                    Item_Check1 = 0;
                    Timeout_Count=0;
                    done=1;
                    Global_delete();
                    }
              }


                if (GlobalModuleID=="Q01"){
                    if (parent.f3.document.all("start_date")){
                    //存在，就填入值
                    parent.f3.document.all("start_date").value= GlobalSDate;
                    parent.f3.document.all("end_date").value= GlobalEDate;
                    parent.f3.document.all("start_time").value= GlobalSTime;
                    parent.f3.document.all("end_time").value= GlobalETime;
                    //TPR(OK)
                    parent.f3.reload_div();
                    //alert("TPR OK");
                    Timeout_Count=0;
                    done=1;
                    Item_Check1 = 0;
                    //初始化為0，避免重複執行
                    Global_delete();
                    }
                }//Q01
                if (GlobalModuleID=="Q02"){
                 if (parent.f3.document.all("start_date")){
                    //存在，就填入值
                    parent.f3.document.all("start_date").value= GlobalSDate;
                    parent.f3.document.all("end_date").value= GlobalEDate;
                    parent.f3.document.all("start_time").value= GlobalSTime;
                    parent.f3.document.all("end_time").value= GlobalETime;
                    //護理記錄(OK)
                    parent.f3.loading_change();
                    //alert("護理紀錄");
                    Timeout_Count=0;
                    done=1;
                    Item_Check1 = 0;
                    //初始化為0，避免重複執行
                    Global_delete();
                    }
                } //Q02
                if (GlobalModuleID=="Q06"){ //給藥作業

                    parent.f3.document.all("select_del_order").checked = true;

                    if (parent.f3.document.all("start_date")){
                    //存在，就填入值
                    parent.f3.document.all("start_date").value= GlobalSDate;
                    parent.f3.document.all("end_date").value= GlobalEDate;
                    parent.f3.document.all("start_time").value= GlobalSTime;
                    parent.f3.document.all("end_time").value= GlobalETime;
                    //給藥 (OK)
                    //alert("這裡是查詢給藥")
                    vv();
                   //parent.f3.loading_change();
                    Timeout_Count=0;
                    done=1;
                    Item_Check1 = 0;
                    GlobalKeyWord_drug = GlobalKeyWord;
                    //初始化為0，避免重複執行
                    Global_delete();

                    //篩選內容
                    //st
                    //alert(window.parent.f3.document.getElementsByClassName("funcArea")[0].parentNode.innerHTML);
                    //window.parent.f3.document.getElementsByClassName("funcArea")[0]=function (){
                    //    alert(“===onbeforeunload===”);
                    //if(event.clientX>document.body.clientWidth && event.clientY < 0 || event.altKey){
                    //    alert(“你關閉了瀏覽器”);
                    //}else{
                    //    alert(“你正在重新整理頁面”);
                    //}
                    //}
                    //ed
                    }
                } //Q06
                if (GlobalModuleID=="Q07"){
                    if (parent.f3.document.all("start_date")){
                    //存在，就填入值
                    parent.f3.document.all("start_date").value= GlobalSDate;
                    parent.f3.document.all("end_date").value= GlobalEDate;
                    parent.f3.document.all("start_time").value= GlobalSTime;
                    parent.f3.document.all("end_time").value= GlobalETime;
                    //管路評估 尚未驗證，沒有資料 (OK)
                    //alert("這裡是查詢管路評估");

                    //20190730  ../ 多爬一層 查詢按鍵 要加windows 要不然網頁無法顯示。
                    ABC();
                    //BAC();

                    //alert("成功按下查詢~!")
                    //alert(parent);
                    //alert(parent.f3);
                    //alert(parent.f3.location);
                    //alert(parent.f3.location.href);
                    //alert(windows.parent.f3.location.href);


                    //alert("owo3");
                    //alert(parent.f3.$('.1').fadeOut(0).value);
                    //alert("AVA2");
                    //alert(parent.f3.$('.1'));
                    //$('#parent').fadeOut('slow');
                    //alert($("input[class='.2']").val());
                    //alert("owo");

                    //parent.f3.$('.1').fadeOut(0);
                    //parent.f3.$('.0').fadeOut(0);
                    //parent.f3.$('.2').fadeIn(0);

                   //parent.f3.loading_change();
                   //window.location.href='Assessment_List?starttime=' + $('#start_date').val() + ' ' + $('#start_time').val() + '&endtime=' + $('#end_date').val() + ' ' + $('#end_time').val()
                    Timeout_Count=0;
                    done=1;
                    Item_Check1 = 0;
                    //初始化為0，避免重複執行
                    Global_delete();
                    }
                }// Q07

           }  //ItemCheck == 1

        }
        if (done==0){
            //不存在，就在等3秒鐘.
            setTimeout('check_page();',500);
            Timeout_Count +=1;
        }

}

//select
function select_item(){

    if(parent.f3.document.all("select_all_order").checked){
    //alert("已經近來Select_Item");
    if(GlobalKeyWord_drug == "全部"){
        parent.f3.document.all("select_all_order").checked = true;
    }else if(GlobalKeyWord_drug == "已DC"){
        parent.f3.document.all("select_del_order").checked = true;
    }else if(GlobalKeyWord_drug == "未DC"){
        parent.f3.document.all("select_act_order").checked = true;
    }else{
        parent.f3.document.all("select_all_order").checked = true;
    }

    GlobalKeyWord_drug = "";
    parent.f3.find_medcode();
    }else{
        setTimeout('select_item();',500);
    }
}


function checkUser(vType){

	//找登入者帳號
	var userobj = parent.f2.document.all("Guiderid");
	if (userobj){
		//alert("有找到登入人員");
		//alert("登入帳號：" + userobj.value);


		//這裡之後為至Server取得此登入人員口說指令。


		//執行轉頁/查詢功能
		//先預設此病歷號00749684，之後由系統傳入
		changePage(userobj.value,vType);


		//第二種取得方式
		//----------------------------------
		//var userobj2 = parent.f2.document.all("leftMenuPanel")
		//if (userobj2){
		//	alert(userobj2.getAttribute("userid"));
		//	//setP(userobj2.getAttribute("userid"));
		//}

	} else {
		//alert("尚未登入");
		//setTimeout('checkUser(1);',3000);
	}
}

function changePage(userid,vType){

    //userid = 帳號 ex:nis168

	var data="C";
    alert("ASDADASDASD");
	var b;
	var modelID;
	var xmlObj1;
	var vCheck=0;

	var vURL="";
    var ptno="";

	var b = document.all("FuncSelect");
	var modelID = b.options[b.selectedIndex].value;

	//alert("1");
	if (vType==1){
	    //功能選取後觸發
		b = document.all("FuncSelect");
		modelID = b.options[b.selectedIndex].value;
		xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func");
		vCheck=1;
	} else if (vType==2) {
	    //查詢下拉選單選取後觸發
	    //alert("vType=2");
		b = document.all("FuncQuery");
		modelID = b.options[b.selectedIndex].value;
		xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func[@type='query' and @model_id='" + modelID + "']");
		vCheck=1;
	} else if (vType==3) {
        b = document.all("FuncSelect");
        modelID = Module_ID;
        //alert("ModuleID = " + modelID);
        xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func[@type='page' and @model_id='" + modelID + "']");
        vCheck=1;
	} else if (vType==4){
	  var input_element = document.getElementById('input_id');
      var text = input_element.value;
      if(text=="")
        alert("請輸入Module ID");
      else
        alert("您輸入的Module ID是: " + text);
		b = document.all("FuncSelect");
		modelID = text;
		xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func[@type='page' and @model_id='" + modelID + "']");
		vCheck=1;
	} else if (vType==5){
		alert("a_1");
		alert(userid);
		var xmlDoc_vv = parseXml2("xml/" + userid + "_vv.xml");
		//alert("xml/" + userid + "_vv.xml");
		xmlObj_vv = xmlDoc_vv.documentElement.getElementsByTagName("func[@type='tag']");

		//Add by Ray 抓到就先刪除，看是否可以解決，第二次呼叫時，XML 沒有刪除的問題。
		//deleteXML("nis168");
		alert("xmlObj_vv" + xmlObj_vv.length);
        if (xmlObj_vv.length>0){
        	alert("b");
		var Module_ID = xmlObj_vv[0].getAttribute("model_id");
		var KeyWord = xmlObj_vv[0].getAttribute("KeyWord");
		var SDate = xmlObj_vv[0].getAttribute("SDate");
        var EDate = xmlObj_vv[0].getAttribute("EDate");
        var STime = xmlObj_vv[0].getAttribute("STime");
        var ETime = xmlObj_vv[0].getAttribute("ETime");
        var PageName = xmlObj_vv[0].getAttribute("PageName");
        var Func = xmlObj_vv[0].getAttribute("Func");
		//抓取fee_no
		var Fee_no = "";
		var Ptno_no = "";
		var Fee_no = xmlObj_vv[0].getAttribute("fee_no");//I033xxx
		var Ptno_no = xmlObj_vv[0].getAttribute("ptno");//"00749684";
		//alert("Fee_no = " + Fee_no);
		//alert("Ptno_no = " + Ptno_no);
		//ptno = Fee_no;//I033xxx
		//
		b = document.all("FuncSelect");  //b找下拉選單
		modelID = Module_ID;
		GlobalKeyWord = KeyWord;
		GlobalSDate = SDate;
		GlobalEDate = EDate;
		GlobalSTime = STime;
		GlobalETime = ETime;
		GlobalPageName = PageName;
		GlobalFunc = Func;
		//alert("GlobalPageName = " + GlobalPageName);
		//alert("ModuleID = " + modelID);
		//alert("GlobalKeyWord = " + GlobalKeyWord);
		//alert("GlobalSDate = " + GlobalSDate);
		//alert("GlobalEDate = " + GlobalEDate);
		//alert("GlobalSTime = " + GlobalSTime);
		//alert("GlobalETime = " + GlobalETime);
		xmlObj1 = xmlDoc.documentElement.getElementsByTagName("func");
		vCheck=1;
		alert("c");
	
	//Add by Ray
	//=========================

	for (var i=0;i<xmlObj1.length;i++){
		//if (xmlObj1.item(i).getAttribute("model_id") == modelID){
		//	vURL = xmlObj1.item(i).getAttribute("module");
        //    alert("vURL = " + vURL);
		//}
		//document.getElementById("Test").value)

		//20190805 查詢pagename對應的網址
		if(xmlDoc.documentElement.getElementsByTagName("func")[i].firstChild.nodeValue == GlobalPageName){
		alert("d");
			if(GlobalFunc == xmlObj1.item(i).getAttribute("type")){
			    vURL = xmlObj1.item(i).getAttribute("module");
			    GlobalFunc = ""; //初始化避免在執行一次
		    }else if(GlobalFunc == xmlObj1.item(i).getAttribute("type")){
		        vURL = xmlObj1.item(i).getAttribute("module");
		        GlobalFunc = ""; //初始化避免在執行一次
		    }
		}

		//alert("每個的item文字 = " + xmlDoc.documentElement.getElementsByTagName("func")[i].firstChild.nodeValue);
		//alert("e");
	} //for



        } //if (xmlObj_vv.length>0)
        else{
            alert("bb");
        }
            alert("cc");
	} //else if (vType==5)
//alert("vType:" + vType);
  if (vCheck==1){
    //找到XML內有Tag



	   if (vType !=5){
            		vURL = xmlObj1(0).getAttribute("module");
		}
           // alert(vURL);
            alert("f");
            //var ptno = "00749684";
            //var Fee_no = xmlObj_vv[0].getAttribute("fee_no");//I033xxx
		    //var Ptno_no = xmlObj_vv[0].getAttribute("ptno");//"00749684";
		    //ptno = Fee_no;//I033xxx
            if(Fee_no != "" && Fee_no != null){
                 $.ajax({
                        url: "../../NIS_VOICE/Main/SetPatient", timeout: 5000, type: "post",
                        data: "fee_no=" + Fee_no,
                        success: function () {
                        alert("g");
                    //alert("success");
                    //alert("有進來Fee_no裡面data = " + data);
                    //取得病人資訊，並顯示
                                        parent.f2.GetPtInfoArea();
                                        parent.f2.readMqList();
                                    },
                                    complete: function () {
                                            //alert("complete");
                                            //顯示給藥作業
                                            //parent.f2.ReloadModule("M01");
                                            alert("h");
                                                if (vType==1){
                                                alert("i");
                                                    //語音跳轉
                                                    //主頁面跳轉過去
                                                    parent.f2.ReloadModule(modelID);
                                                } else {
                                                    //語音查詢
                                                    //主頁面可能無法跳轉過去，(例如:TPR是另外跳視窗出來)

                                                   // if (modelID=="Q02"){
                                                        //護理記錄
                                                    //    parent.f2.ReloadModule("M03");
                                                    //} else if(modelID=="Q01"){
                                                    //    parent.f2.ReloadModule("M14");
                                                    //} else {
                                                    //   parent.f2.ReloadModule(modelID);
                                                    //}


                                                }



                                                //把右邊的網址換到[每日評估]
                                                //parent.f3.location.href="../../NIS_VOICE/DailyBodyAssessment/Index";
                                                parent.f3.location.href="" + vURL;

                                                //alert(vURL);
                                                //alert(modelID);

                                                //隱藏中間
                                                //alert(parent.document.all("mainframe").getAttribute("cols"));
                                                parent.document.all("mainframe").setAttribute("cols","0%,0%,100%");

                                               //alert("成功跳轉頁面");

                                               //alert("modelID = " + modelID)

                                               if(modelID=="Q01" || modelID=="Q02" || modelID=="Q03" || modelID=="Q04" || modelID=="Q05" || modelID=="Q06" || modelID=="Q07"){
                                                    //alert("這裡是查詢頁面");
                                                    GlobalModuleID = modelID;
                                                    Timeout_Count=0;
                                                    check_page();
                                                    Item_Check1 = 1; //只執行一次 查詢頁面資料
                                                    //alert("呼叫check_page~!");
                                                }

                                                //20190830
                                                 deleteXML(userid);
                                                //deleteXML("nis168");
                                                //刪除xml peter
                                            }
                                        });
                    //初始化
                    Module_ID = "";
                    KeyWord = "";
                    SDate = "";
                    EDate = "";
                    STime = "";
                    ETime = "";
                    PageName = "";
                    Func = "";
                    //抓取fee_no
                    Fee_no = "";
                    Ptno_no = "";
                    ptno = "";
                    //
            }//Ptno != ""
            else{ //Fee_no == "" && Fee_no == null

            //var Fee_no = xmlObj_vv[0].getAttribute("fee_no");//I033xxx
		    //var Ptno_no = xmlObj_vv[0].getAttribute("ptno");//"00749684";
		    //ptno = Fee_no;//I033xxx

                $.ajax({
                        type: 'POST',
                        url: "../../NIS_VOICE/Main/WebS_InHistory",
                        data: "str_Barcode=" + Ptno_no,
                        success: function (data) {
                        //alert("有近來Ptno Number(Ptno_no)參數 = " + data);//Data是返回的Ptno Number(Ptno_no)參數
                           if (data == "Error"){
                                //alert("此病歷號[" + Ptno_no + "]無住院紀錄，請重新確認。");
                          }
                            else if (data == "NotInIpd"){
                                //ipdhistory();
                          }
                         else {
                              //alert("good");
                 $.ajax({
                                    url: "../../NIS_VOICE/Main/SetPatient", timeout: 5000, type: "post",
                                    data: "fee_no=" + data,
                                    success: function () {
                    //alert("success");
                      //alert("data = " + data)
                    //取得病人資訊，並顯示
                                        parent.f2.GetPtInfoArea();
                                        parent.f2.readMqList();
                                    },
                                    complete: function () {
                                            //alert("complete");
                                            //顯示給藥作業
                                            //parent.f2.ReloadModule("M01");

                                                if (vType==1){
                                                    //語音跳轉
                                                    //主頁面跳轉過去
                                                    parent.f2.ReloadModule(modelID);
                                                } else {
                                                    //語音查詢
                                                    //主頁面可能無法跳轉過去，(例如:TPR是另外跳視窗出來)

                                                   // if (modelID=="Q02"){
                                                        //護理記錄
                                                    //    parent.f2.ReloadModule("M03");
                                                    //} else if(modelID=="Q01"){
                                                    //    parent.f2.ReloadModule("M14");
                                                    //} else {
                                                    //   parent.f2.ReloadModule(modelID);
                                                    //}


                                                }



                                                //把右邊的網址換到[每日評估]
                                                //parent.f3.location.href="../../NIS_VOICE/DailyBodyAssessment/Index";
                                                parent.f3.location.href="" + vURL;

                                                //alert(vURL);
                                                //alert(modelID);

                                                //隱藏中間
                                                //alert(parent.document.all("mainframe").getAttribute("cols"));
                                                parent.document.all("mainframe").setAttribute("cols","0%,0%,100%");

                                               //alert("成功跳轉頁面");

                                               //alert("modelID = " + modelID)

                                               if(modelID=="Q01" || modelID=="Q02" || modelID=="Q03" || modelID=="Q04" || modelID=="Q05" || modelID=="Q06" || modelID=="Q07"){
                                                    //alert("這裡是查詢頁面");
                                                    GlobalModuleID = modelID;
                                                    Timeout_Count=0;
                                                    check_page();
                                                    Item_Check1 = 1; //只執行一次 查詢頁面資料
                                                    //alert("呼叫check_page~!");
                                                }

                                                //20190830
                                                 deleteXML(userid);
                                                //deleteXML("nis168");
                                                //刪除xml peter
                                                                    }
                                                                });

                                                            }

                                                        },
                                                        error: function (data) {
                                                            alert("查無此病歷號[" + Ptno_no + "]，請重新確認。");
                                                        }

                });
                    //初始化
                    Module_ID = "";
                    KeyWord = "";
                    SDate = "";
                    EDate = "";
                    STime = "";
                    ETime = "";
                    PageName = "";
                    Func = "";
                    //抓取fee_no
                    Fee_no = "";
                    Ptno_no = "";
                    ptno = "";
                    //
            } //Ptno == "";

        }
}


function  deleteXML(userid){

                            var t = new Date(); //避免參數一樣，導致瀏覽器不動作(快取問題)
                            //alert("刪除1");
                            window.open("aspx_test.aspx?func=delete&userid=" + userid + "&t="+t,"");
                            $.ajax({
                                            url: "aspx_test.aspx", timeout: 100, type: "post",
                                            data: "func=delete&userid=" + userid + "&t="+t,
                                success: function () {
                                    //alert("刪除2");
                                    //alert("success");timeout=5000 最多等五秒
                                },
                                complete: function () {
                                }
                            });

}

//alert("good");

//等3秒後，執行checkUser(1)
//setTimeout('checkUser(1);',3000);

function backtoHome(){
	//隱藏右邊
	parent.document.all("mainframe").setAttribute("cols","0%,100%,0%");
}

function changeURL(model_id){

}



function parseXml(fileName){


	try{//Internet Explorer

		xmlDoc=new ActiveXObject("Microsoft.XMLDOM");

		xmlDoc.async = "false";

		//加载 XML文档,获取XML文档对象

		xmlDoc.load(fileName);

	}
	catch(e){

		//Firefox, Mozilla, Opera, etc.

		try{

			xmlDoc=document.implementation.createDocument("","",null);

			xmlDoc.async = "false";

			//加载 XML文档,获取XML文档对象

			xmlDoc.load(fileName);

		}catch(e){


     			try{//Google Chrome
				var xmlhttp=new window.XMLHttpRequest();

				xmlhttp.open("get",fileName,false);

				xmlhttp.send(null);

				xmlDoc=xmlhttp.responseXML;


			}catch(e){
				alert("您的浏览器不能正常加载文件。请切换到兼容模式，或者更换浏览器");

			}

		}

	}

	return xmlDoc;
}
//
function parseXml2(fileName){

	try{//Internet Explorer

		xmlDoc_vv=new ActiveXObject("Microsoft.XMLDOM");

		xmlDoc_vv.async = "false";

		//加载 XML文档,获取XML文档对象

		xmlDoc_vv.load(fileName);

	}
	catch(e){

		//Firefox, Mozilla, Opera, etc.

		try{

			xmlDoc_vv=document.implementation.createDocument("","",null);

			xmlDoc_vv.async = "false";

			//加载 XML文档,获取XML文档对象

			xmlDoc_vv.load(fileName);

		}catch(e){


     			try{//Google Chrome
				var xmlhttp=new window.XMLHttpRequest();

				xmlhttp.open("get",fileName,false);

				xmlhttp.send(null);

				xmlDoc_vv=xmlhttp.responseXML;


			}catch(e){



				alert("您的浏览器不能正常加载文件。请切换到兼容模式，或者更换浏览器");

			}

		}

	}

	return xmlDoc_vv;

}


</script>

<body>

<center>
    語音模擬Demo
</center>


<br><br>
<fieldset>
    <table>
        <tr><td>頁面快轉</td></tr>
        <tr><td><span id="pageselect"></span></td></tr>
        <tr><td><input type="button" onclick="checkUser(1);" value="GO"></td></tr>
    </table>
</fieldset>


<br><br>
<fieldset>
    <table>
        <tr><td>語音查詢</td></tr>
        <tr><td><span id="queryselect"></span></td></tr>
        <tr><td><input type="button" onclick="checkUser(2);" value="GO"></td></tr>
    </table>
</fieldset>

<br><br>
自動語音命令測試
<br>
<input type="button" onclick="checkUser(3);" value="前往">

<br><br>
手動語音命令測試
<br><input type="text" value="" id='input_id'><br>
<input type="button" onclick="checkUser(4);" value="前往">

<br><br><br><br>
<input type="button" onclick="backtoHome();" value="回首頁">


<!--//"http://demo.mayaminer.com.tw/NIS_ECK/Main/SetPatient?fee_no=I033097  00749684"-->

</body>
<script>

var xmlDoc_vv = parseXml2("voicecontrol_vv-2.xml");
xmlObj_vv = xmlDoc_vv.documentElement.getElementsByTagName("func[@type='tag']");
//alert(xmlObj_vv.length);
var Module_ID = xmlObj_vv[0].getAttribute("model_id")
//alert(Module_ID)
//alert(xmlObj_vv[0].getAttribute("model_id"))//
//var txt = xmlObj_vv[0].getAttribute("model_id") //txt=M39

//顯示[頁面快轉]的下拉選單
var xmlDoc_ = parseXml("voicecontrol_vv.xml");
xmlObj = xmlDoc.documentElement.getElementsByTagName("func[@type='page']");
//alert(xmlObj.length);
var vstr = "<select name='FuncSelect'>";
for (var i=0;i<xmlObj.length;i++){
	//alert(xmlObj.item[i]);
	vstr += "<option value='" + xmlObj[i].getAttribute("model_id") + "'>" + xmlObj[i].text + "</option>" ;
}
vstr += "</select>";
//alert(vstr);
document.all("pageselect").innerHTML = vstr;


//顯示[語音查詢]的下拉選單
xmlObj = xmlDoc.documentElement.getElementsByTagName("func[@type='query']");
//alert(xmlObj.length);

var vstr = "<select name='FuncQuery'>";
for (var i=0;i<xmlObj.length;i++){
	//alert(i);
	vstr += "<option value='" + xmlObj[i].getAttribute("model_id") + "'>" + xmlObj[i].text + "</option>" ;
	//var Text = xmlObj[i].getAttribute("model_id")
	//alert(xmlObj[i].getAttribute("model_id"))
}
vstr += "</select>";
//alert(vstr);
document.all("queryselect").innerHTML = vstr;
</script>
<input type="button" name="按查詢" onclick="parent.f3.reload_div();">
</html>


<input type="button" onclick="alert(' ')" value="TEST1">
<input type="button" onclick="vv();" value="TEST1_innerHTML">
<input type="button" onclick="alert('PPAP');" value="TEST2">
<input type="button" onclick='alert(parent.f3.document);' value="TEST3">
<input type="button" onclick='alert(document.getElementsByClassName("div").innerHTML);' value="TEST4">
<input type="button" onclick='alert(document.getElementsByClassName("div"));' value="TEST5">
<input type="button" onclick='alert(parent.f3.getElementsByClassName("dataHeader")[0].innerHTML);' value="TEST6">
<input type="button" onclick='alert(parent.f3);' value="TEST7">
<input type="button" onclick='alert(parent);' value="TEST8">
<input type="button" onclick='alert(document);' value="TEST9">
<input type="button" onclick='alert(document.getElementsByClassName("funcArea")[0].innerHTML);' value="TEST10">
<input type="button" onclick='alert(window.parent.document.getElementsByClassName("funcArea")[0].innerHTML);' value="TEST11">
<input type="button" onclick='ABC();' value="TEST12">
<input type="button" onclick='BAC();' value="TEST13">
<input type="button" onclick='nurse();' value="護理紀錄查詢">

<script>
    function ABC(){
       // alert(window.parent.f3.document.getElementsByClassName("dataHeader")[0].parentNode.innerHTML);
       // alert(window.parent.f3.document.getElementsByClassName("dataHeader")[0].parentNode.parentNode.innerHTML);

        window.parent.f3.document.getElementsByClassName("dataHeader")[0].parentNode.parentNode.style.display="none";
        window.parent.f3.document.getElementsByClassName("dataHeader")[1].parentNode.parentNode.style.display="none";
        window.parent.f3.document.getElementsByClassName("dataHeader")[2].parentNode.parentNode.style.display="none";

        if(GlobalKeyWord == "動靜脈類管路"){
            window.parent.f3.document.getElementsByClassName("dataHeader")[0].parentNode.parentNode.style.display="";
            window.parent.f3.document.getElementsByName("ass_type")[0].checked = true;
        }else if(GlobalKeyWord == "非縫線類管路"){
            window.parent.f3.document.getElementsByClassName("dataHeader")[1].parentNode.parentNode.style.display="";
            window.parent.f3.document.getElementsByName("ass_type")[1].checked = true;
        }else if(GlobalKeyWord == "有縫線類管路"){
            window.parent.f3.document.getElementsByClassName("dataHeader")[2].parentNode.parentNode.style.display="";
            window.parent.f3.document.getElementsByName("ass_type")[2].checked = true;
        }else{
            window.parent.f3.document.getElementsByClassName("dataHeader")[0].parentNode.parentNode.style.display="";
            window.parent.f3.document.getElementsByName("ass_type")[0].checked = true;
        }

        windows.parent.f3.location.href = '?starttime=' +  GlobalSDate + ' ' + GlobalSTime + '&endtime=' + GlobalEDate + ' ' + GlobalETime;
    }
    function BAC(){
        //alert(window.parent.f3.document.getElementsByName("ass_type")[0].parentNode.innerHTML);
        window.parent.f3.document.getElementsByName("ass_type")[2].checked = true;
    }

    //給藥作業
    function vv(){

        //alert(window.parent.f3.document.getElementById("sys_Block").parentNode.innerHTML);
        //window.parent.f3.document.getElementById("sys_Block").style.display="";
        //window.parent.f3.document.getElementById("sys_Loading").style.display="";

        //alert(window.parent.f3.document.getElementsByTagName("form")[0].innerHTML);
        //alert(window.parent.f3.document.getElementsByClassName("funcArea")[0].parentNode.innerHTML);
        //alert(window.parent.f3.document.getElementsByClassName("funcArea")[0].parentNode.parentNode.innerHTML);

        //if(GlobalKeyWord == "全部"){
        //    parent.f3.document.all("select_all_order").checked = true;
        //}else if(GlobalKeyWord == "已DC"){
        //    parent.f3.document.all("select_del_order").checked = true;
        //}else if(GlobalKeyWord == "未DC"){
        //    parent.f3.document.all("select_act_order").checked = true;
        //}

        parent.f3.document.all("ExecFlag").value = "quiryInterval";
        window.parent.f3.document.getElementsByTagName("form")[0].submit();

        select_item();

        //window.parent.f3.document.getElementsByClassName("funcArea")[0].parentNode.innerHTML.submit();
        //alert("這裡是vv哦^v^~!");


        //if (doit('quiryInterval')){
        //    submit();
        //    alert("1");
        //}
        //alert("2");
        //$('#sys_Block, #sys_Loading').show();
        //alert("3");
        //if(doit('quiryInterval')){
        //    alert("doit裡面的值是true!");
        //}else{
        //   alert("doit裡面的值是false!");
        //}
        //alert(if(('quiryInterval'))'我是大帥哥');
    }
    function nurse(){
        alert(window.parent.f3.document.getElementById("form1").parentNode.innerHTML);
    }
</script>
