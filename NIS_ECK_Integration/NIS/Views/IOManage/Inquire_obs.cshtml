@{
    Layout = "~/Views/Layout/FormLayout.cshtml";
    string title = "攝入/輸出 單日查詢";
    string hour = ViewBag.hour;
    string unit = ViewBag.unit;
    string hisview = ViewBag.hisview;
    string[] ShiftClassName = { "白班", "小夜班", "大夜班" };//new
    string[] ShiftClassNo = { "D", "E", "N" };//new
    string[] shiftClassN = { "23", "00", "01", "02", "03", "04", "05", "06" };//大夜時間(開頭時間)
    string[] shiftClassD = { "07", "08", "09", "10", "11", "12", "13", "14" };//白
    string[] shiftClassE = { "15", "16", "17", "18", "19", "20", "21", "22" };//小夜
    int LossCount = ViewBag.LossCount;
    string[] unitStr = { "mL", "g", "mg", "分鐘", "次" };

    DataTable new_dt = ViewBag.dt_new_io_day_query;
    //日期選擇器，鎖定時間
    NIS.Data.PatientInfo pf = (NIS.Data.PatientInfo)Session["PatInfo"];
    NIS.Data.Complement_List complement_List = (NIS.Data.Complement_List)Session["Complement_List"];
}
@* @functions
    {
            public string GetDTResult(DataTable dt, string str)
            {
                var tmpdtrow = from tmpresult in dt.AsEnumerable()
                               where tmpresult.Field<string>("ITEMID") == str
                               select tmpresult;
                string ret = string.Empty;
                if(tmpdtrow.Count<DataRow>() > 0)
                {
                    DataTable resultdt = tmpdtrow.CopyToDataTable();
                    ret = resultdt.Rows[0]["ITEMVALUE"].ToString();
                }
                return ret;

            }
    }*@
<style type="text/css">
    .popup {
        width: 450px;
        height: 250px;
        position: absolute;
        background-color: #EFEFFF;
        padding: 10px 15px 10px 15px;
        border: 1px solid #999999;
        /*box-shadow: 5px 5px 5px #666;
        border-radius: 15px 15px 15px 15px;*/
        top: 50%;
        left: 50%;
        margin: -190px 0 0 -130px; /* [-(height/2)px 0 0 -(width/2)px] */
        display: none;
        z-index: 99;
    }

    .dataArea td {
        border-bottom: 1px solid rgba(20%,20%,40%,0.5);
        text-align: left;
        /*white-space: nowrap;*/
    }

    #module_define {
        padding: 5px 0px 3px 0px;
        text-align: center;
        background-color: #9999FF;
        width: 100%;
        border: 1px solid #BBBBBB;
        border-right: 2px solid #999999;
        border-bottom: 2px solid #999999;
    }
</style>
<script type="text/javascript">
    var hisview = '@(hisview)'

    $(function () {
        close_pup_window();
        setGridColor();
        $("#ddl_total_interval").val('@(hour)');
        $("#unit").val('@(unit)');
        ComputeTotal();
        item_val_br();
        if (hisview == "T") {
            $("input[type='button'][hid_remark='hid']").each(function () {
                $(this).hide();
            });
            $("td[hid_remark='hid']").each(function () {
                $(this).hide();
            });
            $("textarea[hid_remark='hid']").each(function () {
                $(this).hide();
            });

        }

    });
    //格行換色
    function setGridColor() {
        var tr = $('.dataArea tr');
        var color = '#ABC8E2';
        for (var i = 0; i < tr.length; i++) {
            if ($(tr[i]).css('display') != 'none') {
                $(tr[i]).css('background', color);
                if (color == '#ABC8E2')
                    color = '#E1E6FA';
                else
                    color = '#ABC8E2';
            }
        }
        $('.head').css('background', '#85A5CC');
    }

    function add_content(obj, txtid) {
        if (obj.checked)
            $('#' + txtid).val($('#' + txtid).val() + obj.value + '，');
        else
            $('#' + txtid).val($('#' + txtid).val().replace(new RegExp("(" + obj.value + '，' + ")*", "g"), ''));
    }

    function send_content(txtid) {
        loop_windows("open_cover");
        $.ajax({
            type: 'post',
            url: 'Insert_Record',
            data: { Com: $('#' + txtid).attr('record'), I: $('#' + txtid).val() },
            success: function (result) {
                if (result != '')
                    alert(result);
            },
            complete: function () {
                loop_windows("close_cover");
            },
            error: function () {
                loop_windows("close_cover");
            }
        });
    }

    function pup_window(url, width, height) {
        //url += '&day=' + $('#txtdate').val();
        new_window.push(window.open(url, 'top_dialog', 'menubar=no,status=no,scrollbars=yes,top=0,left=200,toolbar=no,width=' + width + ',height=' + height));
    }

    //直排類別統計
    function ComputeTotal() {
        var TempIOValue = ["I", "O", "B_M" ,"B_T"];
        var TempIOClass = ["D", "E", "N"];
       // var Temp_Class_Total = 0.00;//班別小計的暫存
        var Temp_Class_Total_IO = 0.00;///不管I還是O的暫存
        for (var i = 0; i < 4; i++) {
            for (var j = 0; j < 3; j++) {
                var Tempint = 0;
                $("[name=lab_timelist_element][ptempio=" + TempIOValue[i] + "][ptempclass=" + TempIOClass[j] + "]").each(function () {
                    var Temp_temppint = 0;
                    Temp_temppint = ($(this).text() == "") ? "0" : $(this).text();/////2016/07/12v修改jarvis
                    Tempint = Tempint + parseFloat(Temp_temppint);
                });
                var Temp_value = ((Tempint.toFixed(3)) == "0.000") ? "0" : (Tempint.toFixed(3));//
                //StrTotal += parseFloat(Math.round(Temp_value * 100)) / 100;

                $("#lab_" + TempIOValue[i] + "_txt_" + TempIOClass[j]).text(parseFloat(Math.round(Temp_value * 1000)) / 1000);//(Tempint).toString()///2016/07/19v修改jarvis

            }
        }
        LateralTotal();
        LossTotal();
        var total = parseFloat($("#lab_I_AllTotal").text()) - parseFloat($("#lab_O_AllTotal").text()); //計算輸入減去輸出值
        $("#lab_Compute_AllTotal").text(total);
        var Temploss = 0;//以下計算LOSS.總量
        for (var i = 0; i < 2; i++) {
            Temploss = 0;
            $("[name=lab_txt_loss_data_" + TempIOValue[i] + "]").each(function () {
                Temploss = Temploss + parseInt($(this).text());
            });
            $("#lab_" + TempIOValue[i] + "_Loss_AllTotal").text(Temploss.toString());
            var ddd = $("#lab_" + TempIOValue[i] + "_Loss_AllTotal").text();
            //
            if ($("#lab_" + TempIOValue[i] + "_Loss_AllTotal").text() != "0") {
                $("#lab_" + TempIOValue[i] + "_Loss_AllTotal").show();
                $("#lab_" + TempIOValue[i] + "_Loss_Str1").show();
                $("#lab_" + TempIOValue[i] + "_Loss_Str2").show();
            }
        }
        ////增加班別的差異量計算顯示
        for(var i=0;i<TempIOClass.length;i++)
        {
            var StrTotal = " ";
            var Temp_Class_Total = parseFloat($("#lab_I_txt_" + TempIOClass[i]).text()) - parseFloat($("#lab_O_txt_" + TempIOClass[i]).text());
            if (Temp_Class_Total > 0)
            {
                StrTotal = " +";
            }
            //StrTotal += Temp_Class_Total.toFixed(2);
            var Temp_value = ((Temp_Class_Total.toFixed(3)) == "0.00") ? "0" : (Temp_Class_Total.toFixed(3));//
            //parseFloat(Math.round(value*100))/100
            //StrTotal += Temp_value;
            StrTotal += parseFloat(Math.round(Temp_value * 1000)) / 1000;

            $("#lab_class_small_total_" + TempIOClass[i]).text(StrTotal);
        }
    }

    //橫排時間區間內統計
    function LateralTotal() {
        var TempInt = 0;
        var TempIOClass = ["D", "E", "N"];
        var TempIOValue = ["I", "O"];
        for (var j = 0; j < 2; j++) {
            TempInt = 0;
            for (var i = 0; i < 3; i++) {
                TempInt = TempInt + parseFloat($("#lab_" + TempIOValue[j] + "_txt_" + TempIOClass[i]).text());
            }
            $("#lab_" + TempIOValue[j] + "_AllTotal").text((TempInt).toString());
        }
    }

    //計算loss-每班
    function LossTotal() {
        var TempIOClass = ["D", "E", "N"];
        var IlossTemp = 0;
        var OlossTemp = 0;
        for (var i = 0; i < TempIOClass.length; i++) {
            IlossTemp = 0;
            OlossTemp = 0;
            $("[name=td_timehour_total][ptempclass=" + TempIOClass[i] + "]").each(function () {
                IlossTemp = IlossTemp + parseInt($(this).attr("pilossvalue"));
                OlossTemp = OlossTemp + parseInt($(this).attr("polossvalue"));//輸出
            });
            $("#lab_txt_loss_data_I_" + TempIOClass[i]).text(IlossTemp.toString());
            $("#lab_txt_loss_data_O_" + TempIOClass[i]).text(OlossTemp.toString());
            if (parseInt($("#lab_txt_loss_data_I_" + TempIOClass[i]).text()) != "0") {
                $("#lab_txt_loss_data_I_" + TempIOClass[i]).show();
                $("#lab_txt_loss_Str1" + TempIOClass[i]).show();
                $("#lab_txt_loss_Str2" + TempIOClass[i]).show();
            }
            if (parseInt($("#lab_txt_loss_data_O_" + TempIOClass[i]).text()) != "0") {
                $("#lab_txt_loss_data_O_" + TempIOClass[i]).show();
                $("#lab_txt_loss_Str3" + TempIOClass[i]).show();
                $("#lab_txt_loss_Str4" + TempIOClass[i]).show();
            }
        }
    }

    //帶入護理記錄按扭
    function Take_CareRecord(classNo, date, typei, className) {
        loop_windows("open_cover");
        $.ajax({
            type: 'post',
            url: '@Url.Content("~/IOManage/TakeCareRecord")',
            data: {
                Pclass: classNo, PclassName: className, Pdate: date, Ptypei: typei,
                PIValue: $("#lab_I_txt_" + classNo).text(), POValue: $("#lab_O_txt_" + classNo).text(),
                PBMValue: $("#lab_B_M_txt_" + classNo).text(),PBTValue: $("#lab_B_T_txt_" + classNo).text(),
                PITOTAL: $("#lab_I_AllTotal").text(), POTOTAL: $("#lab_O_AllTotal").text(),
                Ploss: '@(LossCount)', PclasslossI: parseInt($("#lab_txt_loss_data_I_" + classNo).text()), PclasslossO: parseInt($("#lab_txt_loss_data_O_" + classNo).text()),
                Pdealwith: $("#texta_dealwith_" + classNo).val(), PdealwithALL: $("#texta_dealwith_ALL").val(), Punit: '@(unit)',
                AllTotal: $("#AllTotal").val(),
                txtdate: $("#txtdate").val(),
                Func_from : "Inquire"
            },
            success: function (data) {
                if (data == "Y")
                { alert('帶入護理紀錄成功!'); }
                else
                { alert('帶入護理紀錄失敗!'); }
            },
            complete: function () {
                loop_windows("close_cover");
            },
            error: function () {
                loop_windows("close_cover");
            }
        });
    }
    function loading_change(_this) {
        if (hisview != "T") {
            loop_windows("open_cover");
        }
        $("#form1").submit();
    }
    function PupWindow(url, width, height, top) {
        var pURL = url; pURL = pURL.replace('&amp;', '&');
        new_window.push(window.open(pURL, '_blank', 'menubar=no,status=no,scrollbars=yes,top=Tp,left=200,toolbar=no,width=' + width + ',height=' + height));
    }
    function item_val_br() {
        $("[name=lab_type_panme]").each(function () {
            var item_val = $(this).html();
            switch (item_val) {
                case '由口進食':
                    $(this).html('由口<br>進食');
                    break;
                case '管灌飲食':
                    $(this).html('管灌<br>飲食');
                    break;
                case '含乳時間':
                    $(this).html('含乳<br>時間');
                    break;
                case '排便次數':
                    $(this).html('排便<br>次數');
                    break;
                case '排尿次數':
                    $(this).html('排尿<br>次數');
                    break;
                default:
                    break;

            }
        });
    }
</script>
@using System.Data;
@{
    string date = ViewBag.date;
    DataTable dtType = ViewBag.dtType;
    //DateTime dateStrStartE = Convert.ToDateTime(date + " 23:00:00").AddDays(-1);//舊
    DateTime dateStrStartE = Convert.ToDateTime(date + " 07:01:00");//新

    // DateTime FirstTimeEnd = Convert.ToDateTime(date + " 23:00:00").AddDays(1).AddHours(int.Parse(hour));
    int count = (8 / int.Parse(hour)) + 1;
    string TempClass = "";//註記在每一格數字上，代表班別
}
<form id="form1" action="Inquire_obs" method="post">
    <div class="funcArea">
        <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; padding-bottom: 10px;">
            <tbody>
                <tr>
                    <td>
                        <div id="module_define">@title</div>
                    </td>
                </tr>
                <tr>
                    <td style="padding-top: 5px;">
                        日期：<input id="txtdate" name="txtdate" style="width: 80px; font-size: 12px;" type="text" value="@(date)" readonly="readonly">
                        @*@WebTool.setDateTime("txtdate")*@
                        @WebTool.complementList_Status(complement_List.Status, pf.InDate.AddDays(-1).ToString("MM/dd/yyyy HH:mm"), @DateTime.Now.ToString("yyyy/MM/dd"), "txtdate", "", false)
                        <select id="unit" name="unit" style="display: none;">
                            <option value="1" selected>mL</option>
                            <option value="2">g</option>
                            <option value="3">mg</option>
                        </select>
                        @Html.Label("lab_total_interval", "統計區間：")
                        <select id="ddl_total_interval" name="ddl_total_interval">
                            <option value="1">1小時</option>
                            <option value="2" selected>2小時</option>
                            <option value="4">4小時</option>
                            <option value="8">8小時</option>
                        </select>
                        <input type="button" value="查詢" style="width: 80px;" onclick="loading_change();">
                        <input type="hidden" name="obs" value="T">
                        <input type="hidden" name="hisview" value="@hisview">
                        <input type="button" hid_remark="hid" value="範圍查詢" style="width: 80px;" onclick="window.location.href = '../IOManage/IO_Range_Index?obs=T';">
                        <input type="button" hid_remark="hid" value="新增攝入/輸出" style="width: 120px;" onclick="window.location.href = '../IOManage/IO_Insert_List';">@*window.location.href = 'Insert';*@
                        <input type="button" hid_remark="hid" value="引流管輸出量統計" style="width: 140px;" onclick="window.location.href = '../IOManage/Inquire_tube?obs=T&hisview=@(hisview)';">
                        <input type="hidden" value="" style="width: 120px;" onclick="window.location.href = '../IOManage/Index';">@*window.location.href = 'Insert';*@
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</form>
<div class="dataHeader" id="dataHeader">
    <table border="0" cellpadding="4" cellspacing="1" style="table-layout: fixed; white-space: nowrap; width: 100%;" class="dtl_VS">
        <tbody>
            <tr>
                <td style="width: 14.8%;" colspan="2">
                    <div style="overflow: hidden;">&nbsp;</div>
                </td>
                <td style="width: 27.3%; text-align: center;" colspan="5">
                    <div style="overflow: hidden;">攝入</div>
                </td>
                <td style="width: 27.3%; text-align: center;" colspan="5">
                    <div style="overflow: hidden;">輸出</div>
                </td>
                <td style="width: 16.38%; text-align: center;" colspan="3">
                    <div style="overflow: hidden;">產嬰</div>
                </td>
                <td style="width: 7.1%; text-align: center;" rowspan="2">合計</td>
                <td hid_remark="hid" style="width: 7.1%; text-align: center;" rowspan="2">處置</td>
            </tr>
            <tr>
                <td style="width: 7.7%; text-align: center; font-size: 12px;">班別</td>
                <td style="width: 7.1%; text-align: center; font-size: 12px;">時間 \ 部位</td>
                @for (int i = 0; i < dtType.Rows.Count; i++)
                {
                    <td style="width: 5.46%; text-align: center;">
                        <label style="font-size:12px;" name="lab_type_panme" pvalue="@dtType.Rows[i]["P_VALUE"]">@(dtType.Rows[i]["P_NAME"])</label>
                    </td>
                }
            </tr>
        </tbody>
    </table>
</div>
<div class="dataArea" onscroll="document.getElementById('dataHeader').scrollLeft = this.scrollLeft;" style="height: 280px; width: 100%;">
    <table border="0" cellpadding="4" cellspacing="1" style="width: 100%;">
        @{
            DateTime dateStrEndE = dateStrStartE.AddHours(23);
            int hourtotalcount = 0, classnamecount = 0, classnamearray = 0, dealwithcount = 0;
        }
        @for (DateTime x = dateStrStartE; x <= dateStrEndE; x = x.AddHours(int.Parse(hour)))
        {
            double Ihourtotalamount = 0, Ohourtotalamount = 0, B_mins_hourtotalamount = 0, B_times_hourtotalamount = 0;


            hourtotalcount++;
            classnamecount++;
            dealwithcount++;
            @Html.Raw("<tr style='background: rgb(171, 200, 226);'>")
            string DateclassOnName = (classnamearray != 2) ? (x.ToString("yyyy/MM/dd")) : (x.AddDays(1).ToString("yyyy/MM/dd"));
            if ((classnamecount % (8 / int.Parse(hour))) == 1)//8 / int.Parse(hour)&&count
            {
                //塞前面班別的及明細合併框格
                @Html.Raw("<td class='head' rowspan='" + count + "' style='width: 7.6%; background: rgb(133, 165, 204); text-align: center;'><label style='font-size:11px;'>" + DateclassOnName + "</label><br />" + ShiftClassName[classnamearray] + " ")
                @Html.Raw("<br />")
                @Html.Raw("<input type='button' value='明細' onclick='pup_window(\"Detail?date=" + ShiftClassNo[classnamearray] + "&hisview=" + hisview + "&day=" + DateclassOnName + "&feeno=" + pf.FeeNo + "\", \"1000\", \"500\");'>")
                @Html.Raw("<br />")
                @Html.Raw("</td> ")
            }
            else if (hour == "8")
            {
                @Html.Raw("<td class='head' rowspan='2' style='width: 7.6%; background: rgb(133, 165, 204); text-align: center;'><label style='font-size:11px;'>" + DateclassOnName + "</label><br />" + ShiftClassName[classnamearray] + " ")
                @Html.Raw("<br />")
                @Html.Raw("<input type='button' value='明細' onclick='pup_window(\"Detail?date=" + ShiftClassNo[classnamearray] + "&hisview=" + hisview + "&day=" + DateclassOnName + "&feeno=" + pf.FeeNo + "\", \"1000\", \"500\");'>")
                @Html.Raw("<br />")
                @Html.Raw("</td> ")
            }
            if (x <= dateStrEndE)
            {
                @Html.Raw("<td style='width: 7.1%;'>")
                @Html.Raw("<div style='overflow: hidden;'><label>")
                @(x.ToString("HH"))  @Html.Raw("-") @(x.AddHours(int.Parse(hour)).ToString("HH"))
                @Html.Raw("</label></div>")
                @Html.Raw("</td>")
                if ((shiftClassN.Any(s => x.ToString("HH").Contains(s))))
                {
                    TempClass = "N";
                }
                else if ((shiftClassD.Any(s => x.ToString("HH").Contains(s))))
                {
                    TempClass = "D";
                }
                else if ((shiftClassE.Any(s => x.ToString("HH").Contains(s))))
                {
                    TempClass = "E";
                }
                int count_i_loss = 0, count_o_loss = 0, count_bmins_loss = 0, count_btimes_loss = 0;

                DateTime dt2 = x;//起始時間
                DateTime dt3 = x.AddHours(Convert.ToInt32(hour)).AddMinutes(-1);
                string i_hour_total = "", o_hour_total = "";
                for (int y = 0; y < dtType.Rows.Count; y++)
                {
                    string TempStrio = "";
                    if (y + 1 >= 1 && y + 1 <= 5)
                    {
                        TempStrio = "I";
                    }
                    else if (y + 1 >= 6 && y + 1 <= 10)
                    {
                        TempStrio = "O";
                    }
                    else if (y + 1 == 11)
                    {
                        TempStrio = "B_M";//Baby_Minute
                    }
                    else if (y + 1 == 12 || y + 1 == 13)
                    {
                        TempStrio = "B_T";//Baby_times
                    }
                    string lab_temp_timeList = "";
                    if (new_dt != null && new_dt.Rows.Count > 0)
                    {
                        for (int z = 0; z < new_dt.Rows.Count; z++)
                        {
                            DateTime dt1 = Convert.ToDateTime(new_dt.Rows[z]["CREATETIME"]);
                            if (((y + 1).ToString() == new_dt.Rows[z]["TYPEID"].ToString()) && (dt1 >= dt2) && (dt3 >= dt1))//DateTime.Compare(dt2, dt1) < 0 && DateTime.Compare(dt1, dt3) < 0)// (new_dt.Rows[z]["C_REASON"] != "1")
                            {//還需要加條件
                             //   if (new_dt.Rows[z]["C_REASON"].ToString() != "1")
                                if (new_dt.Rows[z]["AMOUNT"] != null && new_dt.Rows[z]["AMOUNT"].ToString() != "")
                                {
                                    double Temp_Amount = (lab_temp_timeList == "") ? 0 : Convert.ToDouble(lab_temp_timeList);
                                    lab_temp_timeList = (Temp_Amount + Convert.ToDouble(new_dt.Rows[z]["AMOUNT"])).ToString();

                                    if (lab_temp_timeList == "")
                                    {
                                        break;
                                    }
                                }
                                else
                                {
                                    if (y + 1 >= 1 && y + 1 <= 5)
                                    {
                                        count_i_loss++;
                                    }
                                    else if (y + 1 >= 6 && y + 1 <= 10)
                                    {
                                        count_o_loss++;
                                    }
                                    // break;
                                }
                            }
                        }

                    }
                    string Temp_Amount_Str = (lab_temp_timeList == "") ? "0" : lab_temp_timeList;//處理合計
                    if (y + 1 >= 1 && y + 1 <= 5)
                    {
                        Ihourtotalamount += Convert.ToDouble(Temp_Amount_Str);
                    }
                    else if (y + 1 >= 6 && y + 1 <= 10)
                    {
                        Ohourtotalamount += Convert.ToDouble(Temp_Amount_Str);
                    }
                    else if (y + 1 == 11)
                    {
                        B_mins_hourtotalamount += Convert.ToDouble(Temp_Amount_Str);
                    }
                    else if (y + 1 == 12 || y + 1 == 13)
                    {
                        B_times_hourtotalamount += Convert.ToDouble(Temp_Amount_Str);
                    }
                    @Html.Raw("<td style='width: 5.46%; word-break:break-all;' name='td_timelist_element' ><label name='lab_timelist_element' style='font-size:13px;' ptempio='" + TempStrio + "' ptempclass='" + TempClass + "' ptemp_loss=''>" + lab_temp_timeList + "</label></td>")@*內容Amount加總*@
                    // i_hour_total = (Ihourtotalamount.ToString("F3") == "0.000") ? "0" : Ihourtotalamount.ToString("F3");//將值取小數第二位，再將值如遇到0.00，寫成0
                    // o_hour_total = (Ohourtotalamount.ToString("F3") == "0.000") ? "0" : Ohourtotalamount.ToString("F3");
                }
                @Html.Raw("<td style='width: 7.1%;word-break:break-all;' name='td_timehour_total'  ptempclass='" + TempClass + "' hourtemp='" + x.Hour + "' pilossvalue='" + count_i_loss + "' polossvalue='" + count_o_loss + "'>")
                @Html.Raw("<label style='font-size: 10px;color:red;'>" + Math.Round(Ihourtotalamount, 3).ToString())@*合計*@
                //if(count_i_loss > 0)
                //{
                //@Html.Raw("<label style='font-size: 10px;'> +loss</label>")
                //}
                @Html.Raw(" / ")
                @Html.Raw(Math.Round(Ohourtotalamount, 3).ToString())
                //if(count_o_loss > 0)
                //{
                //@Html.Raw("<label style='font-size: 10px;'> +loss</label>")
                //}
                @Html.Raw("</label>")
                @Html.Raw("<br />")
                @Html.Raw("</td>")//合計每行的時間區間
                if ((dealwithcount % (8 / int.Parse(hour))) == 1)//8 / int.Parse(hour)&&count
                {
                    @Html.Raw("<td hid_remark='hid' style='width: 7.1%;height:100%; text-align: center;' rowspan='" + count + "'>")
                    @Html.Raw("<input type='button' hid_remark='hid' value='措施' onclick='PupWindow(\"../VitalSign/SharedVitalSign?pCtrl=texta_dealwith_" + TempClass + "&pType=io\", 500, 600, \"0\")' />")
                    @Html.Raw("<p></p>")
                    @Html.Raw("<textarea id='texta_dealwith_" + TempClass + "' style='height:120px;width: 100%;padding: 0;vertical-align: bottom;border: none;'></textarea>")
                    @Html.Raw("<p></p>")
                    @Html.Raw("<input type='button' hid_remark='hid' value='帶入護理記錄' style='width:50px;height:60px;white-space:normal; word-break:break-all;overflow:hidden;font-size: 14px;' onclick='Take_CareRecord(\"" + ShiftClassNo[classnamearray] + "\",\"" + DateclassOnName + "\",\"1\",\"" + ShiftClassName[classnamearray] + "\")'>")
                    classnamearray++;
                    @Html.Raw("</td>")
                }
                else if (hour == "8")
                {
                    @Html.Raw("<td hid_remark='hid' style='width: 7.1%;height:100%; text-align: center;' rowspan='2'>")
                    @Html.Raw("<input type='button' hid_remark='hid' value='措施' />")
                    @Html.Raw("<p></p>")
                    @Html.Raw("<textarea id='texta_dealwith_" + TempClass + "' style='height:80px;width: 100%;padding: 0;vertical-align: bottom;border: none;'></textarea>")
                    @Html.Raw("<p></p>")
                    @Html.Raw("<input type='button' hid_remark='hid' value='帶入護理記錄' style='width:50px;height:60px;white-space:normal; word-break:break-all;overflow:hidden;font-size: 14px;' onclick='Take_CareRecord(\"" + ShiftClassNo[classnamearray] + "\",\"" + DateclassOnName + "\",\"1\",\"" + ShiftClassName[classnamearray] + "\")'>")
                    classnamearray++;
                    @Html.Raw("</td>")
                }
                @Html.Raw("</tr>")
            }
            if (hourtotalcount == 8 / int.Parse(hour))
            {
                hourtotalcount = 0;
                @Html.Raw("<tr style='background: rgb(225, 230, 250);'>")
                @Html.Raw("<td>小計</td>")
                @Html.Raw("<td colspan='14'>")
                @Html.Raw("<label id='lab_I_txt_" + TempClass + "'></label>" + unitStr[Convert.ToInt32(unit) - 1])
                @Html.Raw(" <label id='lab_txt_loss_Str1" + TempClass + "' style='display:none;'> +loss</label><label id='lab_txt_loss_data_I_" + TempClass + "' name='lab_txt_loss_data_I' style='display:none;'></label><label id='lab_txt_loss_Str2" + TempClass + "' style='display:none;'>次</label>")
                @Html.Raw(" / ")
                @Html.Raw("<label id='lab_O_txt_" + TempClass + "'></label>" + unitStr[Convert.ToInt32(unit) - 1])
                @Html.Raw(" <label id='lab_txt_loss_Str3" + TempClass + "' style='display:none;'> +loss</label><label id='lab_txt_loss_data_O_" + TempClass + "' name='lab_txt_loss_data_O' style='display:none;'></label><label id='lab_txt_loss_Str4" + TempClass + "' style='display:none;'>次</label>")
                @Html.Raw("(")
                @Html.Raw("<label id='lab_class_small_total_" + TempClass + "'></label>")
                @Html.Raw(" mL / 8hr ) + ")
                @Html.Raw("<label id='lab_B_M_txt_" + TempClass + "'></label>" + unitStr[3])
                @Html.Raw(" <label id='lab_txt_loss_Str1" + TempClass + "' style='display:none;'> +loss</label><label id='lab_txt_loss_data_I_" + TempClass + "' name='lab_txt_loss_data_I' style='display:none;'></label><label id='lab_txt_loss_Str2" + TempClass + "' style='display:none;'>次</label>")
                @Html.Raw(" + ")
                @Html.Raw("<label id='lab_B_T_txt_" + TempClass + "'></label>" + unitStr[4])
                @Html.Raw(" <label id='lab_txt_loss_Str3" + TempClass + "' style='display:none;'> +loss</label><label id='lab_txt_loss_data_O_" + TempClass + "' name='lab_txt_loss_data_O' style='display:none;'></label><label id='lab_txt_loss_Str4" + TempClass + "' style='display:none;'>次</label>")
                @Html.Raw("</td></tr>")
            }
        }
        <tr style="background: rgb(171, 200, 226);">
            <td colspan="2">
                <div style="overflow: hidden; text-align: center;">
                    攝入/輸出總計
                    @Html.Raw("<br />")
                    @Html.Raw("<input type='button' hid_remark='hid' value='帶入護理記錄' style='white-space:normal; word-break:break-all;overflow:hidden;font-size: 12px; ' onclick='Take_CareRecord(\"\",\"" + date + "\",\"2\",\"\")'>")
                </div>
                <p></p>
                <div style="overflow: hidden; text-align: center;">
                    @Html.Raw("<input type='button' value='當日明細' style='white-space:normal; word-break:break-all;overflow:hidden;font-size: 12px; ' onclick='pup_window(\"Detail?date=all&hisview="+hisview+"&day=" + dateStrStartE.ToString("yyyy/MM/dd") + "&feeno=" + pf.FeeNo+ "\", \"1000\", \"500\");'>")
                </div>
            </td>
            <td colspan="9">
                <label>@ViewBag.totle</label>
                <input id='AllTotal' name="AllTotal" type="hidden" value="@ViewBag.totle" />
            </td>
            @Html.Raw("<td style='height:100%;' colspan='6'><textarea hid_remark='hid' id='texta_dealwith_ALL' style='height:60px;width: 100%;padding: 0;vertical-align: bottom;border: none;'></textarea></td>")
        </tr>
    </table>
</div>
