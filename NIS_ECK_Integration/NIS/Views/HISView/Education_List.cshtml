@{
    Layout = "~/Views/Layout/FormLayout.cshtml";
}

<style type="text/css">
  .dataArea td {
    border-bottom: 1px solid rgba(20%,20%,40%,0.5);
    text-align: left;
    white-space:pre-line;
    word-break:break-all;
  }
</style>

<script type="text/javascript">
    $(function () {
        close_pup_window();
        $(window).resize(function () {
            var height = $(this).outerHeight();
            if (height <= 300)
                height = 450;
            $(".dataArea").outerHeight(height - 120);
        }).trigger("resize");
        setGridColor();
    });

    function setGridColor() {
        //格行換色
        $('.treven').css('background', '#ABC8E2');
        $('.trodd').css('background', '#E1E6FA');
    }

    function set_tr(obj) {
        var click = $(obj).attr('click');
        var tr = $('tr[name=scored]');
        if (click == 'true') {
            $(tr).fadeIn(500);
            $(obj).attr('click', 'false');
        }
        else {
            $(tr).fadeOut(0);
            $(obj).attr('click', 'true');
        }
    }

    function edit_comply() {
        var ck = $('input:checked');
        var ids = '';
        for (var i = 0; i < ck.length; i++) {
            ids += ck[i].value + ',';
        }
        window.location.href = 'Comply?ids=' + ids.substring(0, ids.length - 1);
    }
</script>

@using System.Data;
@{
    DataTable dt = ViewBag.dt;
}
<form action="Score" method="post">
<div class="funcArea">
    <table border="0" cellpadding="0" cellspacing="0" style=" width:100%; font-size:14px;">
        <tr><td style="padding: 5px 0px 5px 0px">
            <div class="dataHeader">
                <table border="0" cellpadding="4" cellspacing="1" style="width:100%;cursor:pointer;" click="true" onclick="set_tr(this);">
                    <tr>
                        <td rowspan="2" style="width:6%;">說明<br />類別</td>
                        <td rowspan="2" colspan="2" style="width:15%;">說明內容</td>
                        <td style="width:9%;">說明對象</td>
                        <td style="width:9%;">使用語言</td>
                        <td style="width:12%;">學習動機</td>
                        <td rowspan="2" style="width:11%;">說明對象<br />自我評值</td>
                        <td style="width:13%;">說明方式</td>
                        <td style="width:9%;">說明日期</td>
                        <td style="width:8%;">說明對象</td>
                        <td rowspan="2" style="width:8%;">評值結果</td>
                    </tr>
                    <tr>
                        <td>文化背景</td>
                        <td>教育程度</td>
                        <td>學習障礙</td>
                        <td>指導內容</td>
                        <td>評值日期</td>
                        <td>衛教陪同<br />人員</td>
                    </tr>
                </table>
            </div>
            <div class="dataArea">
                <table border="0" cellpadding="4" cellspacing="1" style="width:100%;background-color: #FFFFFF;table-layout:fixed;">
                @{string classname = "trodd";
                foreach (DataRow r in dt.Rows)
                {
                    string name = (r["SCORE_TIME"].ToString() != "") ? "scored" : "";
                    <tr class="@classname" name="@name">
                        <td rowspan="2" style="width:6%;">
                            @r["EXPLANATION_NAME"]
                        </td>
                        <td rowspan="2" style="width:3%;">
                        </td>
                        <td rowspan="2" style="width:12%;">
                            @r["NAME"]
                            @if (r["ITEM_REFERENCE_URL"].ToString() != "")
                            {
                            <input id="btn" type="button" value="衛教單張/影片" onclick="@Java_funcion.pup_window(r["ITEM_REFERENCE_URL"].ToString(), 900, 600, "0")" />
                            }
                        </td>
                        <td style="width:9%;">@r["OBJECT"].ToString().Replace("99|","其他：")</td>
                        <td style="width:9%;">@r["LANGUAGE"].ToString().Replace("|",",")</td>
                        <td style="width:12%;">@r["MOTIVE"]</td>
                        <td rowspan="2" style="width:11%;">@r["UNDERSTAND"]</td>
                        <td style="width:13%;">
                            @r["DESCRIPTION"].ToString().Replace("|", ",")
                            @if (r["DESCRIPTION_REPLACE"].ToString() != "")
                            { @:<br />替代方案：@r["DESCRIPTION_REPLACE"]
                            }
                        </td>
                        <td style="width:9%;">@Convert.ToDateTime(r["RECORDTIME"]).ToString("yyyy/MM/dd")</td>
                        <td style="width:8%;">@r["OBJECT_NAME"]</td>
                        <td rowspan="2" style="width:8%;">@r["SCORE_RESULT"]</td>
                    </tr>
                    <tr class="@classname" name="@name" >
                        <td style="width:9%;">@r["NATIONALITY"].ToString().Replace("99|","外籍：")</td>
                        <td style="width:9%;">@r["EDUCATION"]</td>
                        <td style="width:12%;">
                            @r["OBSTACLE"].ToString().Replace("|", ",")
                            @if(r["OBSTACLE_REPLACE"].ToString() != "")
                            { @:<br />替代方案：@r["OBSTACLE_REPLACE"]
                            }
                        </td>
                        <td style="width:13%;">@r["INSTRUCT"].ToString()</td>
                        @if(r["SCORE_TIME"].ToString() != "")
                        {
                        <td style="width:9%;">@Convert.ToDateTime(r["SCORE_TIME"]).ToString("yyyy/MM/dd")</td>
                        }
                        else
                        {
                        <td style="width:9%;"></td>
                        }
                        <td style="width:8%;">@r["ACCOMPANY_NAME"]</td>
                    </tr>
                    if (classname == "trodd")
                    { classname = "treven";}
                    else
                    { classname = "trodd"; }
                }
                }
                </table>
            </div>
        </td></tr>
    </table>
</div>
</form>
