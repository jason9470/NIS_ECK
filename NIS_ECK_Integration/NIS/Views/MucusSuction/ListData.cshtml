@using System.Data;
@using NIS.Data

@{
    DataTable dt = ViewBag.dt;
    int x = 0;
    UserInfo ui = (UserInfo)Session["UserInfo"];

}
<style type="text/css">
    .dataArea td {
        border-bottom: 1px solid rgba(20%,20%,40%,0.5);
        text-align: left;
    }

    #module_define {
        padding: 5px 0px 3px 0px;
        text-align: center;
        background-color: #9999FF;
        width: 100%;
        border: 1px solid #BBBBBB;
        border-right: 2px solid #999999;
        border-bottom: 2px solid #999999;
    }
</style>
<script type="text/javascript">
    $(document).ready(function () {
        setGridColor();
        $(window).resize(function () {
            var height = $(this).outerHeight();
            if (height <= 300)
                height = 450;
            $(".dataArea").outerHeight(height - 140);
        }).trigger("resize");
    });
    function setGridColor() {
        //格行換色
        $('.dataArea tr:odd').css('background', 'rgb(211 237 249)');
        $('.dataArea tr:even').css('background', 'rgb(231, 238, 245)');
    }
</script>
<div class="dataArea">
    @if (dt != null && dt.Rows.Count > 0)
    {
        <table border="0" cellpadding="4" cellspacing="1" style="width: 100%; font-size: 18px;">
            @foreach (DataRow r in dt.Rows)
            {
                string[] TempStrScore = { "是", "否", "無法評估" };
                string TensionStr = "";

                <tr>
                    <td style="width: 16%; text-align: center;">

                        @if (r["MODIFY_NAME"].ToString() == ui.EmployeesName)
                        {
                            <div style="overflow:hidden;width:100%;">
                                <input type="button" class="fun_btn" value="修改" pid="@r["SERIAL"]" onclick="window.location.href = 'Insert?id=' + $(this).attr('pid');" style="width: 50px; background-color: #e58b2e " />
                                <input type="button" class="fun_btn" id="" onclick="DelData('@r["SERIAL"]');" value="刪除" style="width: 50px; background-color: #ed6f6f " />
                                <input type="hidden" id="assess_id_@(x)" value="@r["SERIAL"]" />
                            </div>
                        }

                    </td>
                    <td style="width: 14%; text-align: center;">
                        @Html.Raw(Convert.ToDateTime(r["RECORD_TIME"]).ToString("yyyy/MM/dd HH:mm"))
                    </td>

                    <td style="width: 20%; text-align: center;">
                        @Html.Raw(Convert.ToDateTime(r["START_TIME"]).ToString("yyyy/MM/dd HH:mm"))
                        <br>~<br>
                        @Html.Raw(Convert.ToDateTime(r["END_TIME"]).ToString("yyyy/MM/dd HH:mm"))
                    </td>

                    <td style="width: 9%; text-align: center;">@r["TIMES"]</td>

                    <td style="width: 9%; text-align: center;">@r["VOIUME"]</td>

                    @if (@r["COLOR"].ToString() == "其他")
                    {
                        <td style="width: 9%; text-align: center;">@r["COLOR_OTHER"]</td>
                    }
                    else
                    {
                        <td style="width: 9%; text-align: center;">@r["COLOR"]</td>
                    }

                    @if (@r["NATURE"].ToString() == "其他")
                    {
                        <td style="width: 9%; text-align: center;">@r["NATURE_OTHER"]</td>
                    }
                    else
                    {
                        <td style="width: 9%; text-align: center; ">@r["NATURE"]</td>
                    }

                    @if (r["MODIFY_USER"].ToString() != "")
                    {
                        <td style="width: 14%; text-align: center;">@r["MODIFY_NAME"]</td>
                    }
                    else
                    {
                        <td style="width: 14%; text-align: center;">@r["CREATE_NAME"]</td>
                    }

                </tr>


            }
        </table>
    }
</div>