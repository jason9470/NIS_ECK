@using System.Data;
@{
    ViewBag.Title = "";
    Layout = "~/Views/Layout/FormLayout.cshtml";
    DataTable dt_bf = ViewBag.dt;
    List<SelectListItem> ColorList = (List<SelectListItem>)ViewData["color_drainage"];
    List<SelectListItem> TypeList = (List<SelectListItem>)ViewData["outputnature_Drainage"];

    var BirthDay = ViewBag.BirthDay;
}
<script>
    //格行換色
    function setGridColor() {
        $('.dataArea tr:odd').css('background', '#ABC8E2');
        $('.dataArea tr:even').css('background', '#E1E6FA');

        $('.head').css('background', '#85A5CC');
    }

    $(function () {
        setGridColor();
        //設定高度
        $(window).resize(function () {
            var height = $(this).outerHeight();
            if (height <= 300)
                height = 450;
        }).trigger("resize");
    });
</script>
<link href="~/Content/StyleSheet/BabySystem.css" rel="stylesheet" />
<style>
    div {
        overflow: auto;
        display: block;
    }

        div table {
            min-width: 100%;
        }

            div table tr td {
                min-width: 50px;
            }

    .dataHeader {
        font-weight: bold;
        margin: 1px 1px 1px 1px;
        background-color: #85A5CC;
        text-align: center;
        vertical-align: middle;
        height: 26px;
    }
</style>

<table border="0" cellspacing="0" cellpadding="0" style="width:100%;table-layout:fixed;">
    <tr>
        <td>
            <div class="dataArea" style="height:500px;">
                @if (dt_bf != null)
                {
                    <table border="0" cellpadding="4" cellspacing="1" style="width:100%;font-size:14px;">
                        <tr>
                            <td class="dataHeader" rowspan="3">日期時間</td>
                            <td class="dataHeader" rowspan="3">來源</td>
                            <td class="dataHeader" rowspan="3">胎序</td>
                            <td class="dataHeader" rowspan="2" colspan="2">親子同室</td>
                            <td class="dataHeader" rowspan="2" colspan="3">皮膚接觸</td>
                            <td class="dataHeader" rowspan="2" colspan="3">乳房評估</td>
                            <td class="dataHeader" rowspan="2" colspan="5">嬰兒生理評估</td>
                            <td class="dataHeader" colspan="10">嬰兒餵食評估</td>
                            <td class="dataHeader" rowspan="2" colspan="3">排便</td>
                            <td class="dataHeader" rowspan="2" colspan="3">排尿</td>
                            <td class="dataHeader" rowspan="3">護理<br />處置</td>
                        </tr>
                        <tr>
                            <td class="dataHeader" colspan="6">哺乳母親觀察表</td>
                            <td class="dataHeader" colspan="4">餵食量</td>
                        </tr>
                        <tr>
                            <td class="dataHeader">是</td>
                            <td class="dataHeader">否</td>
                            <td class="dataHeader">是</td>
                            <td class="dataHeader">否</td>
                            <td class="dataHeader">地點</td>
                            <td class="dataHeader">乳<br />頭</td>
                            <td class="dataHeader">乳<br />房</td>
                            <td class="dataHeader">泌<br />乳</td>
                            <td class="dataHeader">清醒</td>
                            <td class="dataHeader">呼吸型態</td>
                            <td class="dataHeader">膚色</td>
                            <td class="dataHeader">肌肉張力</td>
                            <td class="dataHeader">活動力</td>
                            <td class="dataHeader">身體姿勢</td>
                            <td class="dataHeader">反應</td>
                            <td class="dataHeader">情感交流</td>
                            <td class="dataHeader">解剖</td>
                            <td class="dataHeader">含乳</td>
                            <td class="dataHeader">含乳時間</td>
                            <td class="dataHeader">開水</td>
                            <td class="dataHeader">母乳</td>
                            <td class="dataHeader">配方奶</td>
                            <td class="dataHeader">D5W</td>
                            <td class="dataHeader">次數</td>
                            <td class="dataHeader">顏色</td>
                            <td class="dataHeader">性狀</td>
                            <td class="dataHeader">次數</td>
                            <td class="dataHeader">顏色</td>
                            <td class="dataHeader">性狀</td>
                        </tr>
                        @foreach (DataRow r in dt_bf.Rows)
                        {
                            <tr>
                                @if (r["RECORDTIME"].ToString() != "")
                                {
                                    <td>
                                        @Convert.ToDateTime(r["RECORDTIME"]).ToString("yyyy/MM/dd")
                                        <br />
                                        @Convert.ToDateTime(r["RECORDTIME"]).ToString("HH:mm")
                                    </td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td>@r["SOURCE"]</td>
                                <td>@r["NB_SEQ_FEENO"].ToString().Split(',')[0]</td>
                                <td>@r["ROOMIN_Y"]</td>
                                <td>@r["ROOMIN_N"]</td>
                                <td>@r["SKINTOUCH_Y"]</td>
                                <td>@r["SKINTOUCH_N"]</td>
                                @if (r["LOCATION"].ToString() != "")
                                {
                                    var LOCATION = r["LOCATION"].ToString();
                                    if (LOCATION == "0")
                                    {
                                        <td>產房</td>
                                    }
                                    else if (LOCATION == "1")
                                    {
                                        <td>開刀房</td>
                                    }
                                    else if (LOCATION == "2")
                                    {
                                        <td>恢復室</td>
                                    }
                                    else if (LOCATION == "3")
                                    {
                                        <td>嬰兒室</td>
                                    }
                                    else if (LOCATION == "4")
                                    {
                                        <td>產後病房</td>
                                    }
                                    else if (LOCATION == "5")
                                    {
                                        <td>兒科中重度病房</td>
                                    }
                                    else if (LOCATION == "6")
                                    {
                                        <td>兒科加護病房</td>
                                    }
                                    else if (LOCATION == "7")
                                    {
                                        <td>@r["LOCA_OTH"].ToString()</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @{
                                    var right = "右：";
                                    var left = "左：";
                                    if (r["NIPPLE"].ToString() != "" && r["NIPPLE"].ToString().Length == 16)
                                    {
                                        var nipple = r["NIPPLE"].ToString();
                                        var rlist = new List<string>();
                                        var llist = new List<string>();
                                        var nresult = "";
                                        if (nipple[0] == '1')
                                        {
                                            llist.Add("正常");
                                        }
                                        if (nipple[1] == '1')
                                        {
                                            llist.Add("凹");
                                        }
                                        if (nipple[2] == '1')
                                        {
                                            llist.Add("平");
                                        }
                                        if (nipple[3] == '1')
                                        {
                                            llist.Add("短");
                                        }
                                        if (nipple[4] == '1')
                                        {
                                            llist.Add("大");
                                        }
                                        if (nipple[5] == '1')
                                        {
                                            llist.Add("小");
                                        }
                                        if (nipple[6] == '1')
                                        {
                                            llist.Add("破皮");
                                        }
                                        if (nipple[7] == '1')
                                        {
                                            llist.Add("結痂");
                                        }

                                        if (nipple[8] == '1')
                                        {
                                            rlist.Add("正常");
                                        }
                                        if (nipple[9] == '1')
                                        {
                                            rlist.Add("凹");
                                        }
                                        if (nipple[10] == '1')
                                        {
                                            rlist.Add("平");
                                        }
                                        if (nipple[11] == '1')
                                        {
                                            rlist.Add("短");
                                        }
                                        if (nipple[12] == '1')
                                        {
                                            rlist.Add("大");
                                        }
                                        if (nipple[13] == '1')
                                        {
                                            rlist.Add("小");
                                        }
                                        if (nipple[14] == '1')
                                        {
                                            rlist.Add("破皮");
                                        }
                                        if (nipple[15] == '1')
                                        {
                                            rlist.Add("結痂");
                                        }
                                        if (llist.Count != 0)
                                        {
                                            nresult = left + String.Join(",", llist);
                                            if (rlist.Count != 0)
                                            {
                                                nresult += "<br />" + right + String.Join(",", rlist);
                                            }
                                        }
                                        else
                                        {
                                            if (rlist.Count != 0)
                                            {
                                                nresult += right + String.Join(",", rlist);
                                            }
                                        }
                                        <td>@Html.Raw(nresult)</td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                }
                                @{
                                    var bright = "右：";
                                    var bleft = "左：";
                                    if (r["BREAST"].ToString() != "" && r["BREAST"].ToString().Length == 10)
                                    {
                                        var breast = r["BREAST"].ToString();
                                        var rlist = new List<string>();
                                        var llist = new List<string>();
                                        var bresult = "";
                                        if (breast[0] == '1')
                                        {
                                            llist.Add("鬆軟");
                                        }
                                        if (breast[1] == '1')
                                        {
                                            llist.Add("充盈");
                                        }
                                        if (breast[2] == '1')
                                        {
                                            llist.Add("緊繃");
                                        }
                                        if (breast[3] == '1')
                                        {
                                            llist.Add("腫脹");
                                        }
                                        if (breast[4] == '1')
                                        {
                                            llist.Add("硬");
                                        }

                                        if (breast[5] == '1')
                                        {
                                            rlist.Add("鬆軟");
                                        }
                                        if (breast[6] == '1')
                                        {
                                            rlist.Add("充盈");
                                        }
                                        if (breast[7] == '1')
                                        {
                                            rlist.Add("緊繃");
                                        }
                                        if (breast[8] == '1')
                                        {
                                            rlist.Add("腫脹");
                                        }
                                        if (breast[9] == '1')
                                        {
                                            rlist.Add("硬");
                                        }
                                        if (llist.Count != 0)
                                        {
                                            bresult = bleft + String.Join(",", llist);
                                            if (rlist.Count != 0)
                                            {
                                                bresult += "<br />" + right + String.Join(",", rlist);
                                            }
                                        }
                                        else
                                        {
                                            if (rlist.Count != 0)
                                            {
                                                bresult += bright + String.Join(",", rlist);
                                            }
                                        }
                                        <td>@Html.Raw(bresult)</td>
                                    }
                                    else
                                    {
                                        <td></td>
                                    }
                                }
                                @{
                                    var lright = "";
                                    var lleft = "";
                                    var result = "";
                                    if (r["LACT_L"].ToString() == "0")
                                    {
                                        lleft = "左：否";
                                    }
                                    else if (r["LACT_L"].ToString() == "1")
                                    {
                                        lleft = "左：微泌乳";
                                    }
                                    else if (r["LACT_L"].ToString() == "2")
                                    {
                                        lleft = "左：" + r["LACT_LAMT"];
                                    }

                                    if (r["LACT_R"].ToString() == "0")
                                    {
                                        lright = "右：否";
                                    }
                                    else if (r["LACT_R"].ToString() == "1")
                                    {
                                        lright = "右：微泌乳";
                                    }
                                    else if (r["LACT_R"].ToString() == "2")
                                    {
                                        lright = "右：" + r["LACT_RAMT"];
                                    }

                                    if (lleft != "")
                                    {
                                        result = lleft;
                                        if (lright != "")
                                        {
                                            result += "<br />" + lright;
                                        }
                                    }
                                    else
                                    {
                                        result = lright;
                                    }
                                    <td>@Html.Raw(result)</td>
                                }
                                @if (r["AWAKE"].ToString() == "0")
                                {
                                    <td>警醒</td>
                                }
                                else if (r["AWAKE"].ToString() == "1")
                                {
                                    <td>睡覺</td>
                                }
                                else if (r["AWAKE"].ToString() == "2")
                                {
                                    <td>哭鬧</td>
                                }
                                else
                                {
                                    <td></td>
                                }

                                @if (r["BRE_TYP"].ToString() == "0")
                                {
                                    <td>順暢</td>
                                }
                                else if (r["BRE_TYP"].ToString() == "1")
                                {
                                    <td>胸骨凹陷</td>
                                }
                                else if (r["BRE_TYP"].ToString() == "2")
                                {
                                    <td>困難</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["SKIN"].ToString() == "0")
                                {
                                    <td>粉紅</td>
                                }
                                else if (r["SKIN"].ToString() == "1")
                                {
                                    <td>蒼白</td>
                                }
                                else if (r["SKIN"].ToString() == "2")
                                {
                                    <td>發紺</td>
                                }
                                else
                                {
                                    <td></td>
                                }

                                @if (r["MUSCLE"].ToString() == "0")
                                {
                                    <td>佳</td>
                                }
                                else if (r["MUSCLE"].ToString() == "1")
                                {
                                    <td>中</td>
                                }
                                else if (r["MUSCLE"].ToString() == "2")
                                {
                                    <td>弱</td>
                                }
                                else
                                {
                                    <td></td>
                                }

                                @if (r["ACTI"].ToString() == "0")
                                {
                                    <td>強</td>
                                }
                                else if (r["ACTI"].ToString() == "1")
                                {
                                    <td>中</td>
                                }
                                else if (r["ACTI"].ToString() == "2")
                                {
                                    <td>弱</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["BRE_BP1"].ToString() != "" && r["BRE_BP2"].ToString() != "" && r["BRE_BP3"].ToString() != "" && r["BRE_BP4"].ToString() != "" && r["BRE_BP5"].ToString() != "")
                                {
                                    if (r["BRE_BP1"].ToString() == "1" && r["BRE_BP2"].ToString() == "1" && r["BRE_BP3"].ToString() == "1" && r["BRE_BP4"].ToString() == "1" && r["BRE_BP5"].ToString() == "1")
                                    {
                                        <td>順利</td>
                                    }
                                    else
                                    {
                                        <td>待加強</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["BRE_RES1"].ToString() != "" && r["BRE_RES2"].ToString() != "" && r["BRE_RES3"].ToString() != "" && r["BRE_RES4"].ToString() != "")
                                {
                                    if (r["BRE_RES1"].ToString() == "1" && r["BRE_RES2"].ToString() == "1" && r["BRE_RES3"].ToString() == "1" && r["BRE_RES4"].ToString() == "1")
                                    {
                                        <td>順利</td>
                                    }
                                    else
                                    {
                                        <td>待加強</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["BRE_EB1"].ToString() != "" && r["BRE_EB2"].ToString() != "")
                                {
                                    if (r["BRE_EB1"].ToString() == "1" && r["BRE_EB2"].ToString() == "1")
                                    {
                                        <td>順利</td>
                                    }
                                    else
                                    {
                                        <td>待加強</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["BRE_ANA1"].ToString() != "" && r["BRE_ANA2"].ToString() != "" && r["BRE_ANA3"].ToString() != "")
                                {
                                    if (r["BRE_ANA1"].ToString() == "1" && r["BRE_ANA2"].ToString() == "1" && r["BRE_ANA3"].ToString() == "1")
                                    {
                                        <td>順利</td>
                                    }
                                    else
                                    {
                                        <td>待加強</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["BRE_SUC1"].ToString() != "" && r["BRE_SUC2"].ToString() != "" && r["BRE_SUC3"].ToString() != "" && r["BRE_SUC4"].ToString() != "" && r["BRE_SUC5"].ToString() != "")
                                {
                                    if (r["BRE_SUC1"].ToString() == "1" && r["BRE_SUC2"].ToString() == "1" && r["BRE_SUC3"].ToString() == "1" && r["BRE_SUC4"].ToString() == "1" && r["BRE_SUC5"].ToString() == "1")
                                    {
                                        <td>順利</td>
                                    }
                                    else
                                    {
                                        <td>待加強</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["BRE_TSS1"].ToString() != "")
                                {
                                    if (r["BRE_TSS1"].ToString() == "1")
                                    {
                                        <td>@r["BRE_TSS2"]</td>
                                    }
                                    else
                                    {
                                        <td>待加強</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["WATER"].ToString() != "")
                                {
                                    <td>@r["WATER"] ml</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["BRE_MLK"].ToString() != "")
                                {
                                    <td>@r["BRE_MLK"] ml</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["MILK_BD"].ToString() != "" && r["MILK"].ToString() != "")
                                {
                                    <td>@r["MILK_BD"]，@r["MILK"]</td>
                                }
                                else
                                {
                                    <td>@r["MILK_BD"]@r["MILK"]</td>
                                }
                                @if (r["D5W"].ToString() != "")
                                {
                                    <td>@r["D5W"] 次</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["DEF_FRQ"].ToString() != "")
                                {
                                    <td>@r["DEF_FRQ"] 次</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["DEF_COL"].ToString() != "" && r["DEF_COL"].ToString() != "-1")
                                {
                                    if (r["DEF_COL"].ToString() == "99")
                                    {
                                        <td>@r["DEF_COL_OTH"].ToString()</td>
                                    }
                                    else
                                    {
                                        <td>@ColorList.Where(x => x.Value == r["DEF_COL"].ToString()).Select(x => x.Text).FirstOrDefault()</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["DEF_CHA"].ToString() != "" && r["DEF_CHA"].ToString() != "-1")
                                {
                                    if (r["DEF_CHA"].ToString() == "99")
                                    {
                                        <td>@r["DEF_CHA_OTH"].ToString()</td>
                                    }
                                    else
                                    {
                                        <td>@TypeList.Where(x => x.Value == r["DEF_CHA"].ToString()).Select(x => x.Text).FirstOrDefault()</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["URI_FRQ"].ToString() != "")
                                {
                                    <td>@r["URI_FRQ"] 次</td>
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["URI_COL"].ToString() != "" && r["URI_COL"].ToString() != "-1")
                                {
                                    if (r["URI_COL"].ToString() == "99")
                                    {
                                        <td>@r["URI_COL_OTH"].ToString()</td>
                                    }
                                    else
                                    {
                                        <td>@ColorList.Where(x => x.Value == r["URI_COL"].ToString()).Select(x => x.Text).FirstOrDefault()</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                @if (r["URI_CHA"].ToString() != "" && r["URI_CHA"].ToString() != "-1")
                                {
                                    if (r["URI_CHA"].ToString() == "99")
                                    {
                                        <td>@r["URI_CHA_OTH"].ToString()</td>
                                    }
                                    else
                                    {
                                        <td>@TypeList.Where(x => x.Value == r["URI_CHA"].ToString()).Select(x => x.Text).FirstOrDefault()</td>
                                    }
                                }
                                else
                                {
                                    <td></td>
                                }
                                <td style="width:60px">@r["TREAT"]</td>
                            </tr>
                        }
                    </table>
                }
            </div>
        </td>
    </tr>
</table>

<script>
    $('form').on('keyup keypress', function (e) {
        var keyCode = e.keyCode || e.which;
        if (keyCode === 13) {
            e.preventDefault();
            return false;
        }
    });
</script>