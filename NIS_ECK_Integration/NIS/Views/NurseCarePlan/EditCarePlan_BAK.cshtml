@using NIS.Models;
@using System.Data;
@{
    Layout = "~/Views/Layout/FormLayout.cshtml";
    string title = "護理計畫";
    List<Care_Plan_Item> dt_Topic = (List<Care_Plan_Item>)ViewData["dt_Topic"];
    List<Care_Plan_Item> dt_Defin = (List<Care_Plan_Item>)ViewData["dt_Defin"];
    List<Care_Plan_Item> dt_About = (List<Care_Plan_Item>)ViewData["dt_About"];
    List<Care_Plan_Item> dt_Goal = (List<Care_Plan_Item>)ViewData["dt_Goal"];
    //List<Care_Plan_Item> dt_Step = (List<Care_Plan_Item>)ViewData["dt_Step"];
    List<Care_Plan_Item> dt_Active = (List<Care_Plan_Item>)ViewData["dt_Active"];
    DataTable UserFeature = ViewBag.UserFeature;
    DataTable UserInducements = ViewBag.UserInducements;
    DataTable UserTarget = ViewBag.UserTarget;
    DataTable UserMeasure = ViewBag.UserMeasure;
    string recordid = string.Empty;
    //日期選擇器，鎖定時間
    NIS.Data.PatientInfo pf = (NIS.Data.PatientInfo)Session["PatInfo"];
    NIS.Data.Complement_List complement_List = (NIS.Data.Complement_List)Session["Complement_List"];
}

<style type="text/css">
    #topic_panel
    {
        width: 99%;
        /*background-color: white;*/ /*#E8F8EA*/
        margin-top: 3px;
        text-align: left;
        display: inline-block;
        padding: 5px;
        height: 60px;
        background-color: #D9EDF7; /*#E1E6FA;*/
        border: 1px solid silver;
        margin-bottom: 2px;
        /*cursor: pointer;*/
        vertical-align: bottom;
        overflow-y: auto;
        /*font-weight: bold;*/
        margin-left: 2px;
        border-radius: 5px;
        word-break: break-all;
    }

        #topic_panel span
        {
            height: 20px;
        }

        #topic_panel label
        {
            font-weight: bold;
            color: #000000;
        }

    .topic_item
    {
        display: block;
        white-space: nowrap;
        color: #0000CC;
        font-size: 16px;
        font-weight: bold;
    }

    .topic_desc
    {
        display: inline-block;
        color: #993300;
        font-size: 14px;
    }

    .ltc_plan_about, .ltc_plan_definition, .ltc_plan_goal
    {
        width: 100%;
        border: 1px solid silver;
        background-color: #D9EDF7; /*#E1E6FA;*/
        /*height: 180px;*/
        overflow-y: scroll;
        font-size: 14px;
        border-bottom-right-radius: 5px;
        -moz-border-bottom-right-radius: 5px;
        -webkit-border-bottom-right-radius: 5px;
        border-bottom-left-radius: 5px;
        -moz-border-bottom-left-radius: 5px;
        -webkit-border-bottom-left-radius: 5px;
    }

    .ltc_plan_goal
    {
        height: 394px;
    }

    .ltc_plan_goal
    {
        display: block;
    }

    .cp_panel
    {
        display: block;
        width: 100%;
    }

    .dtl_title
    {
        display: block;
        width: 100%;
        font-size: 16px;
        color: #0000CC;
        background-color: #ABC8E2;
        text-align: center;
        font-weight: bold;
        border: 1px solid silver;
        /*border-bottom: 3px double #999;*/
        border-top-right-radius: 5px;
        -moz-border-topright-radius: 5px;
        -webkit-border-topright-radius: 5px;
        border-top-left-radius: 5px;
        -moz-border-topleft-radius: 5px;
        -webkit-border-topleft-radius: 5px;
    }

    .dtl_item
    {
        display: block;
        margin: 2px;
        padding: 2px;
        width: 98%;
        border: 1px solid silver;
        /*background-color: #c8d3fb;*/
    }

        .dtl_item:hover
        {
            background-color: #a9bbfe;
        }

        .dtl_item label
        {
            display: block;
            width: 100%;
            font-size: 16px;
            cursor: pointer;
        }

        .dtl_item > span > span
        {
            display: inline-block;
            width: 95%;
            margin-top: 2px;
            margin-left: 10px;
            padding: 2px;
            border: 1px solid silver;
            background-color: #FFEEDD;
        }

            .dtl_item > span > span:hover
            {
                background-color: #FFCC99;
            }

            .dtl_item > span > span > span > span
            {
                display: inline-block;
                width: 95%;
                margin-top: 2px;
                margin-left: 10px;
                padding: 2px;
                border: 1px solid silver;
                background-color: #CCFFCC;
            }

                .dtl_item > span > span > span > span:hover
                {
                    background-color: #00DD99;
                }

    .dataArea td
    {
        border-bottom: 1px solid rgba(20%,20%,40%,0.5);
        text-align: left;
    }

    #module_define
    {
        padding: 5px 0px 3px 0px;
        text-align: center;
        background-color: #9999FF;
        width: 100%;
        border: 1px solid #BBBBBB;
        border-right: 2px solid #999999;
        border-bottom: 2px solid #999999;
    }
</style>

<script type="text/javascript">
    $(document).ready(function () {
        setGridColor();

        @if (UserFeature.Rows.Count >0)
            {
            string OldFeatureid = string.Empty;
                for(int i = 0;i<UserFeature.Rows.Count;i++)
                {
                    @:$('#FEATURE' + @UserFeature.Rows[i]["FEATUREID"]).click();
                            OldFeatureid += UserFeature.Rows[i]["FEATUREID"].ToString() + ",";
                }
                OldFeatureid = OldFeatureid.Substring(0,OldFeatureid.Length - 1);
                @:$('#OldFeatureid').val('@OldFeatureid');
                        recordid = @UserFeature.Rows[0]["recordid"].ToString();
            }
        @if (UserInducements.Rows.Count > 0)
            {
            string OldRelatedfactorsid = string.Empty;
                for (int i = 0; i < UserInducements.Rows.Count; i++)
                {
                    @:$('#INDUCEMENTS' + @UserInducements.Rows[i]["RELATEDFACTORSID"]).click();
                            OldRelatedfactorsid += @UserInducements.Rows[i]["RELATEDFACTORSID"].ToString() + ",";
                }
                OldRelatedfactorsid = OldRelatedfactorsid.Substring(0, OldRelatedfactorsid.Length - 1);
                @:$('#OldRelatedfactorsid').val('@OldRelatedfactorsid');
                recordid = @UserInducements.Rows[0]["recordid"].ToString();
            }
        @if (UserTarget.Rows.Count > 0)
            {
                for (int i = 0; i < UserTarget.Rows.Count; i++)
                {
                    @:$('#TARGET' + @UserTarget.Rows[i]["TARGETID"]).click();
                                        }
                recordid = @UserTarget.Rows[0]["recordid"].ToString();
            }
        @if (UserMeasure.Rows.Count > 0)
            {
                for (int i = 0; i < UserMeasure.Rows.Count; i++)
                {
                    @:$('#MEASURE' + @UserMeasure.Rows[i]["MEASUREID"]).click();
                                            @:$('#MEAResult' + @UserMeasure.Rows[i]["MEASUREID"]).val('@(UserMeasure.Rows[i]["MEASUREDESC"])');
                                        }
                recordid = @UserMeasure.Rows[0]["recordid"].ToString();
            }

    });
    function setGridColor() {
        //格行換色
        $('.dataArea tr:odd').css('background', '#ABC8E2');
        $('.dataArea tr:even').css('background', '#E1E6FA');
    }

    $(function () {
        $(window).resize(function () {
            var height = $(this).outerHeight();
            if (height <= 300)
                height = 450;
            $(".ltc_plan_definition").outerHeight((height - 200) / 2);
            $(".ltc_plan_about").outerHeight((height - 200) / 2);
            $(".ltc_plan_goal").outerHeight($(".ltc_plan_definition").outerHeight() );
        }).trigger("resize");
    });

    function to_Show(obj, show_id) {
        if (obj.checked)
            $("." + $(obj).attr(show_id)).fadeIn(0);
        else
            div_hidden($(obj).attr(show_id));
    }

    function set_otehr_text(obj) {
        var num = obj.value.indexOf(',');
        if (num > -1) {
            obj.value = replace_(obj.value);
            var range = obj.createTextRange();
            range.move('character', num + 1);
            range.select();
        }
    }

    function replace_(num) {
        return num.replace(/,/g, "，");
    }

    //複製div
    function clonediv(p_id, div_class) {
        //取得屬性值
        var copyPart = $('#' + p_id).clone();     //複製一份
        copyPart.css('display', '');

        //加入複製出來的項目
        $('.' + div_class).append(copyPart);

        rename(p_id);
    }

    //重新命名複製div
    function rename(p_id) {
        var copyPart = $('[clonename=' + p_id + ']');
        for (var i = 1; i < copyPart.length; i++) {
            $(copyPart[i]).attr('id', p_id + '_' + i);
            //修改按鈕id,name,value,bind click事件
            $(copyPart[i]).find('img:eq(0)')
                    .attr('id', p_id + 'btnDel' + i)
                    .attr('delid', p_id + '_' + i);
            //設定radio_清空值
            $('input[type=radio]', copyPart[i]).each(function () { $(this).attr('name', $(copyPart[0]).find('input[type=radio]').attr('name') + '_' + i); });

            document.getElementById(p_id + 'btnDel' + i).setAttribute('onclick', "colDel(this, '" + p_id + "');");
            $('#' + p_id + '_' + i).css('opacity', '100');
            $('#' + p_id + '_' + i).focus();
        }
    }

    //刪除事件
    function colDel(obj, p_id) {
        var delid = $(obj).attr('delid');
        $('#' + delid).remove();
        rename(p_id);
    }

    function clone_goal(p_id, div_class) {
        var copyPart = $('#' + p_id).clone();
        copyPart.css('display', '');
        $('.' + div_class).append(copyPart);
        setDateTime($(copyPart).find('input[name=other_td]'));
        goal_rename(p_id);
    }

    function goal_rename(p_id) {
        var copyPartList = $('[clonename=' + p_id +']');
        for (var i = 1; i < copyPartList.length; i++) {
            $(copyPartList[i]).attr('id', p_id + '_' + i);
            $(copyPartList[i]).find('img:eq(0)')
                    .attr('id', p_id + 'btnDel' + i)
                    .attr('delid', p_id + '_' + i);
            document.getElementById(p_id + 'btnDel' + i).setAttribute('onclick', "goal_colDel(this, '" + p_id + "', 'action_auto_" + i + "' );");
            $(copyPartList[i]).find('img:eq(1)')
                    .attr('id', "img_custom_add_act_" + i)
                    .attr('onclick', "clonediv('action_auto_" + i + "', '" + p_id + '_other_action_' + i + "');");
            $(copyPartList[i]).find('span[temp=Y][class=dtl_item]')
                    .attr('id', 'action_auto_' + i)
                    .attr('clonename', 'action_auto_' + i);
            $(copyPartList[i]).find('input[type=text][temp=Y]').attr('name', p_id + '_other_action_' + i);
            $(copyPartList[i]).find('span[temp=Y][class!=dtl_item]').attr('class', p_id + '_other_action_' + i);

            $('#' + p_id + '_' + i).css('opacity', '100');
            $('#' + p_id + '_' + i).focus();
        };
    }

    function goal_colDel(obj, p_id, pp_id) {
        var delid = $(obj).attr('delid');
        $('#' + delid).remove();
        goal_rename(p_id);
        rename(pp_id);
    }

    function div_hidden(id_list) {
        var list = id_list.split(',');
        for (var i = 0 ; i < list.length; i++) {
            $('.' + list[i]).fadeOut(0);
            $('.' + "selfActivity" + list[i]).empty();
            var input_list = $('.' + list[i] + ' input, .' + list[i] + ' textarea');
            for (var j = 0 ; j < input_list.length; j++) {
                if (input_list[j].type == 'checkbox') {
                    if (input_list[j].checked)
                        $(input_list[j]).click();
                }
            }
        }
    }

    function setDateTime(id) {
        $(id).attr('readonly', 'readonly');
        $(id).datetimepicker({
            showTimepicker: false,
            beforeShowDay: function (date) {
                switch (date.getDay()) {
                    case 6:
                        return [true, 'satday'];
                        break;
                    case 0:
                        return [true, 'sunday'];
                        break;
                    default:
                        return [true, ''];
                        break;
                }
            },
            minDateTime: 0
        });
    }

    function check() {
        var msg = "";
        //定義性特徵驗證
        if ($('input[name=FEATURE]').length > 1 && $('input[type=checkbox][name=FEATURE]:checked').length < 1) {
            msg += "請勾選至少一個定義性特徵\n";
        }
        //if ($('input[name=add_Def]').length > 1) {
        //    $('input[name=add_Def]').each(function (i) {
        //        if (i > 0 && $.trim($(this).val()) == '')
        //            msg += "請輸入自訂義 " + i + " 的定義性特徵\n";
        //    });
        //}
        //else if ($('input[type=checkbox][name=definition]').length > 0 && $('input[type=checkbox][name=definition]:checked').length < 1)
        //    msg += "請勾選或新增一個定義性特徵\n";
        //相關因素驗證
        if ($('input[name=INDUCEMENTS]').length > 1 && $('input[type=checkbox][name=INDUCEMENTS]:checked').length < 1) {
            msg += "請勾選至少一個相關因素\n";
        }
        //if ($('input[name=add_About]').length > 1) {
        //    $('input[name=add_About]').each(function (i) {
        //        if (i > 0 && $.trim($(this).val()) == '')
        //            msg += "請輸入自訂義 " + i + " 的相關因素\n";
        //    });
        //}
        //else if ($('input[type=checkbox][name=about]').length > 0 && $('input[type=checkbox][name=about]:checked').length < 1)
        //    msg += "請勾選或新增一個相關因素\n";
        //目標驗證
        if ($('input[name=TARGET]').length > 1 && $('input[type=checkbox][name=TARGET]:checked').length < 1) {
            msg += "請勾選至少一個目標\n";
        }
        //修改原驗證方式
        //if ($('input[name=other_td]').length > 1) {
        //    $('input[name=other_td]').each(function (i) {
        //        if (i > 0) {
        //            if ($.trim($(this).val()) == '')
        //                msg += "請選擇自訂義 " + i + " 目標時間\n";
        //            if ($.trim($('textarea[name=other_tc]:eq(' + i + ')').val()) == '')
        //                msg += "請輸入自訂義 " + i + " 目標內容\n";
        //            if ($('input[name=goal_other_action_' + i + ']').length > 1) {
        //                var j = i;
        //                $('input[name=goal_other_action_' + j + ']').each(function (i) {
        //                    if (i > 0 && $.trim($(this).val()) == '')
        //                        msg += "請輸入自訂義 " + j + " 目標的 " + i + " 自訂義活動\n";
        //                });
        //            }
        //            else
        //                msg += "請新增自訂義 " + i + " 目標的自訂義活動\n";
        //        }
        //    });
        //}
        //else if ($('input[type=checkbox][name=goal]').length > 0 && $('input[type=checkbox][name=goal]:checked').length < 1)
        //    msg += "請勾選或新增一個目標\n";
        //if ($('input[type=checkbox][name=goal]').length > 0 && $('input[type=checkbox][name=goal]:checked').length > 0) {
        //    $('input[type=checkbox][name=goal]:checked').each(function (i) {
        //        var j = i;
        //        $('input[name=GoalValue' + $(this).attr('id') + ']').each(function (i) {
        //            if ($.trim($(this).val()) == '') {
        //                if (i == 0)
        //                    msg += "請輸入目標 " + (j + 1) + " 日期\n";
        //                else
        //                    msg += "請輸入目標 " + (j + 1) + " 內容\n";
        //            }
        //        });
        //        if ($('input[name=add_Action_' + $(this).attr('id') + ']').length > 1) {
        //            $('input[name=add_Action_' + $(this).attr('id') + ']').each(function (i) {
        //                if (i > 0 && $.trim($(this).val()) == '')
        //                    msg += "請輸入目標 " + (j + 1) + " 的 " + i + " 自訂義活動\n";
        //            });
        //        }
        //        else if ($('input[type=checkbox][name=Act_' + $(this).attr('id') + ']:checked').length < 1)
        //            msg += "請勾選或新增目標 " + (j + 1) + " 的活動\n";

        //        if ($('input[type=checkbox][name=Act_' + $(this).attr('id') + ']:checked').length > 0) {
        //            $('input[type=checkbox][name=Act_' + $(this).attr('id') + ']:checked').each(function () {
        //                var ActText = $('input[type=text][name=' + $(this).attr('iid') + ']').val();
        //                if ($.trim(ActText) == '') {
        //                    msg += "目標 " + (j + 1) + " 的活動未輸入完整，請檢查!\n";
        //                    return false;
        //                }
        //            });
        //        }
        //    });
        //}
        //護理措施
        if ($('input[name=MEASURE]').length > 1 && $('input[type=checkbox][name=MEASURE]:checked').length < 1) {
            msg += "請勾選至少一個護理措施\n";
        }

        if (msg == '') {
            $('input[type=checkbox]:disabled').attr('disabled', false);
            return true;
        }
        else {
            alert(msg);
            return false;
        }
    }

</script>

<div class="funcArea">
    <table border="0" cellpadding="0" cellspacing="0" style="width: 100%">
        <tr>
            <td>
                <div id="module_define">@title</div>
            </td>
        </tr>
        <tr>
            <td style="width: 100%; text-align: left; padding: 0 0 5px 0;">
                <form action="CarePlanEdit" method="post" style="background-color: white;">
                    <input type="hidden" name="recordid" value="@(recordid)" />
                    <input type="hidden" id="OldFeatureid" name="OldFeatureid" />
                    <input type="hidden" id="OldRelatedfactorsid" name="OldRelatedfactorsid" />
                    <div>
                       
                        <input type="button" value="儲存" onclick="if (check()) { submit(); }" />
                         <input type="button" value="返回"  onclick="window.location.href = 'Index';" />
                    </div>
                    <div id="topic_panel" style="float: left;width: 39%;">
                        @if (dt_Topic != null && dt_Topic.Count > 0)
                        {
                            foreach (var item in dt_Topic)
                            {
                                <span class="topic_item">
                                    <label>護理診斷名稱：</label>@(item.DIAGNOSIS_NAME)
                                </span>
                                <span class="topic_desc" style="padding-top: 2px;">
                                    @*為將值傳到controller*@
                                    <input type="hidden" name="f_id" value="@item.DIAGNOSIS_CODE" />
                                    <input type="hidden" name="f_item" value="@item.DIAGNOSIS_NAME" />
                                </span>
                            }
                        }
                        <div style="font-weight: bold; font-size: 16px;">
                            評估時間：
                            @(Html.TextBox("CreateDate", DateTime.Now.ToUniversalTime().AddHours(8).ToString("yyyy/MM/dd"), new { @class = "form-control input-sm", @style = "display:inline-block;" }))
                            @(Html.TextBox("CreateTime", DateTime.Now.ToUniversalTime().AddHours(8).ToString("HH:mm"), new { @class = "form-control input-sm", @style = "display:inline-block;" }))
                            @*@WebTool.setDateTime("CreateDate", "CreateTime", "", "0")*@
                            @WebTool.complementList_Status(complement_List.Status, pf.InDate.ToString("MM/dd/yyyy HH:mm"), @DateTime.Now.ToString("yyyy/MM/dd"), "CreateDate", "CreateTime", false)
                        </div>
                    </div>
                    <div style="WIDTH: 59%; MARGIN-TOP: 3px; FLOAT: right; TEXT-ALIGN: center; position:absolute;left:39%;border-radius: 5px;">
                        <label style="color:blue;font-weight:bold;">病人主訴(S)：</label>
                        <div><textarea cols="65" rows="3" name="S">@ViewBag.S</textarea></div>
                    </div>
                    <table id="cp_info_table" style="width: 100%;">
                        <tr>
                            <td style="width: 40%">
                                <div class="cp_panel">
                                    <span class="dtl_title">定義性特徵
                                        <img src="~/Images/plus.png" style="display:none; width: 18px; height: 18px; cursor: pointer;" onclick="clonediv('difin', 'ltc_plan_definition');" /></span>
                                    <span class="dtl_item" clonename="difin" id="difin" style="vertical-align: middle; display: none;">
                                        <img id="" src="~/Images/minus.png" style="cursor: pointer; width: 15px;" title="刪除" alt="刪除" onclick="" />
                                        <input type="text" name="add_Def" onchange="set_otehr_text(this);" style="width: 90%; display: inline-block;" class="form-control input-sm" />
                                    </span>
                                    <div class="ltc_plan_definition">
                                        @if(dt_Defin != null && dt_Defin.Count > 0) //定義
                                        {
                                            foreach(var item in dt_Defin)
                                            {
                                            <span class="dtl_item">
                                                <label>
                                                    <input type="checkbox" id="FEATURE@(item.FEATURE_CODE)" name="FEATURE" value="@(item.FEATURE_CODE)" />
                                                    @(item.FEATURE_DESC)
                                                    <input type="hidden" name="FEATURE@(item.FEATURE_CODE)" value="@(item.FEATURE_DESC)" />
                                                </label>
                                            </span>
                                            }
                                        }
                                    </div>
                                </div>
                            </td>
                            <td style="width: 60%">
                                <div class="cp_panel">
                                    <span class="dtl_title">請選擇目標
                                        <img id="img_add_goal" src="~/Images/plus.png" style="display:none; width: 18px; height: 18px; cursor: pointer;" onclick="clone_goal('goal', 'ltc_plan_goal');" /></span>
                                    <div class="dtl_item" clonename="goal" id="goal" style="display: none;">
                                        <img id="" src="~/Images/minus.png" style="cursor: pointer; width: 15px;" title="刪除" alt="刪除" onclick="" />
                                        <input type="text" name="other_td" style="width: 90px; display: inline-block;" class="form-control input-sm" />前，
						<textarea name="other_tc" rows="3" cols="30" onchange="set_otehr_text(this);" style="display: inline-block;" class="form-control input-sm"></textarea>
                                        <span>
                                            <span class="dtl_item">自訂義
								<img id="" src="~/Images/plus.png" style="width: 18px; height: 18px" onclick="" />
                                                <span class="dtl_item" temp="Y" clonename="" id="" style="vertical-align: middle; display: none;">
                                                    <img id="" src="~/Images/minus.png" style="cursor: pointer; width: 15px;" title="刪除" alt="刪除" onclick="" />
                                                    <input type="text" temp="Y" name="" onchange="set_otehr_text(this);" style="width: 90%; display: inline-block;" class="form-control input-sm" />
                                                </span>
                                                <span temp="Y" class=""></span>
                                            </span>
                                        </span>
                                    </div>
                                    <div class="ltc_plan_goal">
                                        @if(dt_Goal != null && dt_Goal.Count > 0)  //目標
                                        {
                                            foreach(var item in dt_Goal)
                                            {
                                            <div class="dtl_item">
                                                <label>
                                                    <input type="checkbox" id="TARGET@(item.TARGET_CODE)" name="TARGET" value="@item.TARGET_CODE" @*onclick="to_Show(this, 'gid');"*@ />
                                                    @Html.Raw(item.TARGET_DESC)
                                                    @*@Html.Raw(item.TARGET_DESC.Replace("_____", "<input type='text' name='GoalValue" + item.TARGET_CODE + "' style='width:90px;display:inline-block;' class='form-control input-sm' />"))*@
                                                    <input type="hidden" name="TARGET@(item.TARGET_CODE)" value="@(item.TARGET_DESC)" />
                                                </label>
                                                <span class="@item.TARGET_CODE" style="text-align:left;display:none;width:100%">
                                                    <span class="dtl_item">自訂義
									                    <img src="~/Images/plus.png" style="display:none; width:18px;height:18px" onclick="clonediv('action_@item.TARGET_CODE', 'ltc_plan_action_@item.TARGET_CODE');" />
                                                        <span class="dtl_item" clonename="action_@item.TARGET_CODE" id="action_@item.TARGET_CODE" style="vertical-align:middle;display:none;">
                                                            <img id="" src="~/Images/minus.png" style="cursor: pointer; width: 15px;" title="刪除" alt="刪除" onclick="" />
                                                            <input type="text" name="add_Action_@item.TARGET_CODE" onchange="set_otehr_text(this);" style="width:90%;display: inline-block;" class="form-control input-sm"/>
                                                        </span>
                                                        <span class="ltc_plan_action_@item.TARGET_CODE"></span>
                                                    </span>
                                                </span>
                                            </div>
                                            }
                                        }
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 40%">
                                <div class="cp_panel">
                                    <span class="dtl_title">相關因素
                                        <img src="~/Images/plus.png" style="display:none; width: 18px; height: 18px; cursor: pointer;" onclick="clonediv('about', 'ltc_plan_about');" /></span>
                                    <span class="dtl_item" clonename="about" id="about" style="vertical-align: middle; display: none;">
                                        <img id="" src="~/Images/minus.png" style="cursor: pointer; width: 15px;" title="刪除" alt="刪除" onclick="" />
                                        <input type="text" name="add_About" onchange="set_otehr_text(this);" style="width: 90%; display: inline-block;" class="form-control input-sm" />
                                    </span>
                                    <div class="ltc_plan_about">
                                        @if(dt_About != null && dt_About.Count > 0)
                                        {
                                            foreach(var item in dt_About)
                                            {
                                            <span class="dtl_item">
                                                <label>
                                                    <input type="checkbox" id="INDUCEMENTS@(item.INDUCEMENTS_CODE)" name="INDUCEMENTS" value="@item.INDUCEMENTS_CODE" />
                                                    @item.INDUCEMENTS_DESC
                                                    <input type="hidden" name="INDUCEMENTS@(item.INDUCEMENTS_CODE)" value="@item.INDUCEMENTS_DESC" />
                                                </label>
                                            </span>   
                                            }
                                        }
                                    </div>
                                </div>
                            </td>
                            <td style="width: 60%">
                                <div class="cp_panel">
                                    <span class="dtl_title">
                                        請選擇護理措施
                                        <img id="img_add_goal" src="~/Images/plus.png" style="display:none; width: 18px; height: 18px; cursor: pointer;" onclick="clone_goal('goal', 'ltc_plan_goal');" />
                                    </span>
                                    <div class="dtl_item" clonename="goal" id="goal" style="display: none;">
                                        <img id="" src="~/Images/minus.png" style="cursor: pointer; width: 15px;" title="刪除" alt="刪除" onclick="" />
                                        <input type="text" name="other_td" style="width: 90px; display: inline-block;" class="form-control input-sm" />前，
                                        <textarea name="other_tc" rows="3" cols="30" onchange="set_otehr_text(this);" style="display: inline-block;" class="form-control input-sm"></textarea>
                                        <span>
                                            <span class="dtl_item">
                                                自訂義
                                                <img id="" src="~/Images/plus.png" style="width: 18px; height: 18px" onclick="" />
                                                <span class="dtl_item" temp="Y" clonename="" id="" style="vertical-align: middle; display: none;">
                                                    <img id="" src="~/Images/minus.png" style="cursor: pointer; width: 15px;" title="刪除" alt="刪除" onclick="" />
                                                    <input type="text" temp="Y" name="" onchange="set_otehr_text(this);" style="width: 90%; display: inline-block;" class="form-control input-sm" />
                                                </span>
                                                <span temp="Y" class=""></span>
                                            </span>
                                        </span>
                                    </div>
                                    <div class="ltc_plan_goal">
                                        @if (dt_Active != null && dt_Active.Count > 0)
                                        {
                                            foreach (var step_item in dt_Active)
                                            {
                                                <span class="dtl_item">
                                                    <label>
                                                        <input type="checkbox" id="MEASURE@(step_item.MEASURE_CODE)" name="MEASURE" value="@step_item.MEASURE_CODE" />
                                                        <input type="text" id="MEAResult@(step_item.MEASURE_CODE)" value="@step_item.MEASURE_DESC" name="MEASURE@(@step_item.MEASURE_CODE)" style="width:90%;display: inline-block;" class="form-control input-sm" />
                                                    </label>
                                                </span>
                                            }
                                        }
                                    </div>
                                </div>
                            </td>
                            
                        </tr>
                    </table>
                </form>
            </td>
        </tr>
    </table>
</div>
