@using System.Data;
@{
    DataTable dt = ViewBag.dt;
    int x = 0;
}
<style type="text/css">
  .dataArea td {
    border-bottom: 1px solid rgba(20%,20%,40%,0.5);
    text-align: left;
  }
  #module_define {
        padding: 5px 0px 3px 0px;
        text-align: center;
        background-color: #9999FF;
        width: 100%;
        border: 1px solid #BBBBBB;
        border-right: 2px solid #999999;
        border-bottom: 2px solid #999999;
    }
</style>
<script type="text/javascript">
    $(document).ready(function () {
        setGridColor();
    });
    function setGridColor() {
        //格行換色
        $('.dataArea tr:odd').css('background', '#ABC8E2');
        $('.dataArea tr:even').css('background', '#E1E6FA');
    }
</script>
<div class="dataArea">
                @if(dt != null && dt.Rows.Count > 0)
                {
                    <table border="0" cellpadding="4" cellspacing="1" style="width:100%;font-size:14px;">
                        @foreach(DataRow r in dt.Rows)
                        {
                            string[] TempStrScore = { "完全沒有(0)", "輕微(1)", "中等程度(2)", "厲害(3)", "非常厲害(4)" };
                            string TensionStr = "";
                            if(!string.IsNullOrEmpty(r["TOTAL_SCORE"].ToString()))
                            {
                                int tension = int.Parse(r["TOTAL_SCORE"].ToString());

                                if(tension >= 6 && tension <= 9)
                                { TensionStr = "輕度情緒困擾，建議尋求紓壓管道或接受心理專業諮詢。"; }
                                else if(tension >= 10 && tension <= 14)
                                { TensionStr = "中度情緒困擾，建議諮詢精神科醫師接受進一步評估。"; }
                                else if(tension >= 15)
                                { TensionStr = "重度情緒困擾，建議諮詢精神科醫師接受進一步評估。"; }
                                else if(tension >= 0 && tension <= 5)
                                { TensionStr = "身心適應狀況良好。"; }
                            }
                            else
                            {
                                TensionStr = "";
                            }
                            string TempStr1 = "", TempStr2 = "", TempStr3 = "", TempStr4 = "";
                            TempStr1 = (r["SPIRITUALITY"].ToString().Split('|').GetValue(0).ToString() != "有") ?
                             r["SPIRITUALITY"].ToString().Split('|').GetValue(0).ToString() : TempStr1 = r["SOCIETY_PT"].ToString().Replace('|', ':');
                            TempStr2 = (r["SPIRITUALITY"].ToString().Split('|').GetValue(1).ToString() != "有") ?
                            r["SPIRITUALITY"].ToString().Split('|').GetValue(1).ToString() : TempStr2 = r["SOCIETY_FM"].ToString().Replace('|', ':');
                            TempStr3 = (r["SPIRITUALITY"].ToString().Split('|').GetValue(2).ToString() != "有") ?
                            r["SPIRITUALITY"].ToString().Split('|').GetValue(2).ToString() : TempStr3 = r["RELIGION_PT"].ToString().Replace('|', ':');
                            TempStr4 = (r["SPIRITUALITY"].ToString().Split('|').GetValue(3).ToString() != "有") ?
                            r["SPIRITUALITY"].ToString().Split('|').GetValue(3).ToString() : TempStr4 = r["RELIGION_FM"].ToString().Replace('|', ':');
                        <tr>
                            <td style="width:8.3%;text-align:center;" rowspan="2">
                               @Html.Raw(Convert.ToDateTime(r["ASSESS_DT"]).ToString("yyyy/MM/dd HH:mm"))
                            </td>
                            <td style="width:8.3%;text-align:center;">@((!string.IsNullOrEmpty(r["SCORE_1"].ToString())) ? (TempStrScore[Convert.ToInt32(r["SCORE_1"])]) : "")</td>
                            <td style="width:8.3%;text-align:center;">@((!string.IsNullOrEmpty(r["SCORE_2"].ToString())) ? (TempStrScore[Convert.ToInt32(r["SCORE_2"])]) : "")</td>
                            <td style="width:8.3%;text-align:center;">@((!string.IsNullOrEmpty(r["SCORE_3"].ToString())) ? (TempStrScore[Convert.ToInt32(r["SCORE_3"])]) : "")</td>
                            <td style="width:8.3%;text-align:center;">@((!string.IsNullOrEmpty(r["SCORE_4"].ToString())) ? (TempStrScore[Convert.ToInt32(r["SCORE_4"])]) : "")</td>
                            <td style="width:8.3%;text-align:center;">@((!string.IsNullOrEmpty(r["SCORE_5"].ToString())) ? (TempStrScore[Convert.ToInt32(r["SCORE_5"])]) : "")</td>
                            <td style="width:4.3%;text-align:center;"><label title="@(TensionStr)">@(r["TOTAL_SCORE"])</label></td>
                            <td style="width:8.3%;text-align:center;">@((!string.IsNullOrEmpty(r["SUICIDAL_THOUGHTS_SCORE"].ToString())) ? (TempStrScore[Convert.ToInt32(@r["SUICIDAL_THOUGHTS_SCORE"])]) : "")</td>
                            <td style="width:12.3%;text-align:center;">
                                @r["MEASURE"]
                            </td>
                            <td style="width:8.3%;text-align:center;">
                                @r["REMARK"]
                            </td>
                            <td style="width:8.3%;text-align:center;" rowspan="2">@r["MODIFY_USER_NAME"]</td>
                            <td style="width:8.3%;text-align:center;" rowspan="2">
                                <div style="overflow:hidden;width:100%;">
                                    <input type="button" value="修改" pid="@r["ASSESS_ID"]" onclick="window.location.href = 'Insert?id=' + $(this).attr('pid');" style="width:40px;" />
                                    <input type="button" id="" onclick="DelData('@(x)');" value="刪除" />
                                    <input type="hidden" id="assess_id_@(x)" value="@r["ASSESS_ID"]" />
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="9" style="text-align:left;">
                                 @Html.Raw("<label>社會問題【病人】:</label>" + TempStr1 + "。" + "<br /><label>社會問題【家屬】:</label>" + TempStr2 + "。<br /><label>靈性宗教問題【病人】:</label>" + TempStr3 + "。" + "<br /><label>靈性宗教問題【家屬】:</label>" + TempStr4 + "。")
                            </td>
                        </tr>
                            {
                                x += 1;
                            }
                        }
                    </table>
                }
                </div>