@{
    ViewBag.Title = "護理資訊系統-化療給藥";
    //Layout = "~/Views/Layout/Main.cshtml";
    Layout = "~/Views/Layout/FormLayout.cshtml";
}

<style type="text/css">
  .popup {
    width:auto;
    height:auto;
    position:absolute;
    top:50%;
    left:50%;
    margin:-250px 0 0 -140px; /* [-(height/2)px 0 0 -(width/2)px] */
    display:none;
    background-color:#F0F0F0;
    z-index:99;
  }
</style>

<script type="text/javascript">
    window.onload = function () {
        close_pup_window();
        $("#btn_chemotherapy_execute").css("background-color", "#666666");
        $("#btn_chemotherapy_execute").css("color", "#FFFFFF");
    }
    function showPopup(id) {
        var popup = document.getElementById(id);
        popup.style.display = 'block';
        $("#name").focus();
    }
    function hidePopup(id) {
        var popup = document.getElementById(id);
        popup.style.display = 'none';
    }
   

</script>
@using System.Data;
@using NIS.Data;
@{
    Random rd = new Random();
    DataTable table = ViewBag.table;
   // List<ChemotherapyDrugOrder> chemoOrderList = ViewData["chemoOrderList"];
   
    if(ViewBag.ck != null){
    bool ck = ViewBag.ck;} 
    string udodrgcode = ViewBag.udodrgcode;

    // int number = 1;
    //if (ViewBag.key != null)
    //{ number = int.Parse(ViewBag.key) + 1; }
    DateTime start_day = DateTime.Now;
    DateTime end_day = DateTime.Now;
    if (ViewBag.start_day != null)
    { start_day = ViewBag.start_day; }
    if (ViewBag.end_day != null)
    { end_day = ViewBag.end_day; }
        
  }
<table border="0" cellpadding="0" cellspacing="0" style=" width:100%; text-align:left;">
    <tr><td align="center">
        @Html.Partial("CommonMedicine_Tab")
            
    </td></tr>
    <tr><td style=" padding:10px 0px 5px 0px;">
        @Html.TextBox("start_date", @DateTime.Now.AddDays(-7).ToString("d"), new {style="width:80px" })
@Html.TextBox("start_time", "0000", new {style="width:50px" })
@Html.Label("lab"," ~ ")
@Html.TextBox("end_date", @DateTime.Now.ToString("yyyy/MM/dd"), new {style="width:80px" })
@Html.TextBox("end_time","1159", new { style = "width:50px" })
        <input type="button" class="btn_m" value="查詢" />
        <input type="button" class="btn" value="查詢所有待執行醫囑" />
    </td></tr>
    <tr><td style=" padding:5px 0px 5px 0px;">
        @Html.CheckBox("ck")
        @Html.Label("ck", "是否為補輸資料？")
        @Html.Label("id", "藥包條碼")
        @Html.TextBox("id", "123456789", new { style = " width:180px;" })
        <input type="button" class="btn" value="批次原因註記" onclick="@Java_funcion.pup_window("UnExcuteReason", 400, 400, "");" />
        <input type="button" class="btn_m" value="復原" onclick="alert('復原成功');" />
        <input type="button" class="btn_m" value="完成" onclick="alert('儲存成功');" />
        <input type="button" class="btn_m" value="覆核" onclick="showPopup('popup');" />
             
    </td></tr>
    <tr><td style=" padding:5px 0px 5px 0px;">
        <div class="gv_area">
            <table border="0" cellpadding="0" cellspacing="0" style=" width:100%; padding:0px 0px 25px 0px;">
                <tr>
                    <th rowspan="2" >身高</th>
                    <th rowspan="2" >體重</th>
                    <th rowspan="2" >BSA</th>
                    <th rowspan="2" >Scr</th>
                    <th rowspan="2" >CCr</th>
                    <th rowspan="2" >WBC(ul)</th>
                    <th rowspan="2" >WBC日期</th>
                    <th colspan="3">分類</th>
                    <th rowspan="2" >Stage</th>
                    <th rowspan="2" >ANC</th>
                </tr>
                <tr>
                    <th>T</th>
                    <th>N</th>
                    <th>M</th>
                </tr>
                <tr>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
            </table>
            <div style=" height:400px; overflow:auto;">
                <table border="0" cellpadding="0" cellspacing="0" style=" width:100%; padding:5px 0px 0px 0px;">
                <tr><td colspan="11" style="background-color: #F8BF3A; text-align:center;"><span style="font-weight: bold">Pre-medication</span></td></tr>
                <tr>
                    <th>順序</th>
                    <th>生效時間</th>
                    <th>天數</th>
                    <th>藥物名稱</th>
                    <th>自</th>
                    <th>使用劑量</th>
                    <th>途徑</th>
                    <th>頻次</th>
                    <th>總量(mL)</th>
                    <th>速率(mL/小時)</th>
                    <th>狀態</th>
                </tr>
                 @{             
                    List<ChemotherapyDrugOrder> chemoOrderList = (List<ChemotherapyDrugOrder>)ViewData["chemoOrderList"];
                    for (int i = 0; i <= chemoOrderList.Count - 1; i++)
                    {                   
                        if (chemoOrderList[i] != null)
                        {
                            int s = int.Parse(chemoOrderList[i].OrderStartDate.ToString("dd"));
                            int e = int.Parse(chemoOrderList[i].OrderEndDate.ToString("dd"));
                            int day = e - s;
                        <tr>
                            <td>@chemoOrderList[i].Sequence</td>
                            <td>@chemoOrderList[i].OrderStartDate</td>
                            <td>@day</td>
                            <td>@chemoOrderList[i].DrugName</td>
                            <td>自費別</td>
                            <td>@chemoOrderList[i].Dose@chemoOrderList[i].DoseUnit</td>
                            <td>@chemoOrderList[i].Route</td>
                            <td>@chemoOrderList[i].Feq</td>
                            <td>@chemoOrderList[i].Total</td>
                            <td>@chemoOrderList[i].Rate</td>
                            <td>狀態(未給藥)</td>
                        </tr>
                       @* <tr>
                            <th colspan="3">泡用點滴</th>
                            <td>&nbsp;</td>
                            <th colspan="4">給予頻次及時間</th>
                            <td colspan="3"></td>
                        </tr>*@
                        <tr>
                            <th colspan="3">醫囑備註</th>
                            <td colspan="8">@chemoOrderList[i].Memo</td>
                        </tr>
                        <tr>
                            <td colspan="11" style=" padding:5px 0px 5px 0px;">
                                @Html.CheckBox("CK_a")
                                @Html.Label("CK_a", "執行日期時間：")
                                @Html.TextBox("date", @DateTime.Now.ToString("yyyy/MM/dd"), new { style = "width:80px" })
                                @Html.TextBox("time", "1159", new { style = "width:50px" })
                                <span style=" color:red;">[@ViewBag.name]</span>
                                <span style=" color:blue;">[@ViewBag.name]</span>
                            </td>
                        </tr>                  
                     
                                                   }
                    }
                       chemoOrderList = null;
                    }
            </table>
                <table border="0" cellpadding="0" cellspacing="0" style=" width:100%">
                    <tr><td colspan="11" style="background-color: #F8BF3A; text-align:center;"><span style="font-weight: bold">Chemotherapy</span></td></tr>
                    <tr>
                        <th>順序</th>
                        <th>生效時間</th>
                        <th>天數</th>
                        <th>藥物名稱</th>
                        <th>自</th>
                        <th>使用劑量</th>
                        <th>途徑</th>
                        <th>頻次</th>
                        <th>總量(mL)</th>
                        <th>速率(mL/小時)</th>
                        <th>狀態</th>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
                  @*  <tr>
                        <th colspan="3">泡用點滴</th>
                        <td>&nbsp;</td>
                        <th colspan="4">給予頻次及時間</th>
                        <td colspan="3"></td>
                    </tr>*@
                    <tr>
                        <th colspan="3">醫囑備註</th>
                        <td colspan="8"></td>
                    </tr>
                    <tr>
                        <td colspan="11" style=" padding:5px 0px 5px 0px;">
                            @Html.CheckBox("CK_c")
                            @Html.Label("CK_c", "執行日期時間：")
                            @Html.TextBox("date", @DateTime.Now.ToString("yyyy/MM/dd"), new { style = "width:80px" })
                            @Html.TextBox("time", "1159", new { style = "width:50px" })
                            <span style=" color:red;">[@ViewBag.name]</span>
                            <span style=" color:blue;">[@ViewBag.name]</span>
                        </td>
                    </tr>
                    <tr>
                        <th>順序</th>
                        <th>生效時間</th>
                        <th>天數</th>
                        <th>藥物名稱</th>
                        <th>自</th>
                        <th>使用劑量</th>
                        <th>途徑</th>
                        <th>頻次</th>
                        <th>總量(mL)</th>
                        <th>速率(mL/小時)</th>
                        <th>狀態</th>
                    </tr>
                    <tr>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                        <td>&nbsp;</td>
                    </tr>
                    <tr>
                        <th colspan="3">泡用點滴</th>
                        <td>&nbsp;</td>
                        <th colspan="4">給予頻次及時間</th>
                        <td colspan="3"></td>
                    </tr>
                    <tr>
                        <th colspan="3">醫囑備註</th>
                        <td colspan="8"></td>
                    </tr>
                    <tr>
                        <td colspan="11" style=" padding:5px 0px 5px 0px;">
                            @Html.CheckBox("CK_d")
                          @Html.Label("CK_d", "執行日期時間：")
                            @Html.TextBox("date", @DateTime.Now.ToString("yyyy/MM/dd"), new { style = "width:80px" })
                            @Html.TextBox("time", "1159", new { style = "width:50px" })
                            <span style=" color:red;">[@ViewBag.name]</span>
                            <span style=" color:blue;">[@ViewBag.name]</span>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </td></tr>
    <tr><td style=" padding:25px 0px 5px 0px;">
    </td></tr>
</table>

<div id="popup" class="popup" style=" width:280px; height:150px;">
    <form action="Execute" method="post">
    <table border="0" cellpadding="0" cellspacing="0" style="padding:5px 0px 0px 0px; width:280px; height:150px;">
        <tr><td>
            <fieldset style=" -moz-border-radius: 8px; -webkit-border-radius:8px; padding: 0px 0px 0px 10px; width:95%;">
                <legend style="text-align:center;">覆核者登入</legend>
                <table border="0" style=" padding: 10px 0px 10px 0px; width:260px; height:120px;">
                    <tr><td>
                        <span>帳號：</span>
                        @Html.TextBox("name", "", new { style = " width:150px;" })
                    </td></tr>
                    <tr><td>
                        <span>密碼：</span>
                        @Html.Password("pwd","",new { style=" width:150px;" } )
                    </td></tr>
                    <tr><td align="right">
                        <input type="submit" value="確定" style=" width:50px" />
                        <input id="hide" type="button" value="取消" style=" width:50px" onclick="hidePopup('popup');" />
                    </td></tr>
                </table>
            </fieldset>
        </td></tr>
    </table>
    </form>
</div>