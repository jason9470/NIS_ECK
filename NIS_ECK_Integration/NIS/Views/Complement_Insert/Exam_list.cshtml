@{
    ViewBag.Title = "Exam_list";
    Layout = "~/Views/Layout/FormLayout.cshtml";
    Dictionary<string, string> costlist = (Dictionary<string, string>)ViewData["costlist"];
}

<style type="text/css">
    .dataArea td {
        border-bottom: 1px solid rgba(20%,20%,40%,0.5);
        text-align: left;
        white-space: pre-line;
        word-break: break-all;
    }
    .dataHeader td {
        height:10px;
    }
</style>

<script type="text/javascript">
    $(function () {
        setGridColor();
        change_cost('@ViewBag.cost');
    });

    function setGridColor() {
        //格行換色
        var tr = $('.dataArea tr');
        var color = '#ABC8E2';
        for (var i = 0; i < tr.length; i++) {
            if ($(tr[i]).css('display') != 'none') {
                $(tr[i]).css('background', color);
                if (color == '#ABC8E2')
                    color = '#E1E6FA';
                else
                    color = '#ABC8E2';
            }
        }
        $('.head').css('background', '#85A5CC');
    }

    function change_cost(num) {
        if (num != undefined) {
            $('.dataArea tr').fadeOut(0);
            $('input[name=id_list]:checked').each(function () {
                this.checked = false;
            })
            if (num != '') 
                $('.' + num).fadeIn(0);
            else
                $('.dataArea tr').fadeIn(0);
            setGridColor();
        }
    }
</script>


@using System.Data;
@{
    DataTable dt_complement_list = ViewBag.dt_complement_list;
}
<form action="Insert_Exam" method="post">
<input type="hidden" id="status" name="status" value="" />
<div class="funcArea">
    <table border="0" cellpadding="0" cellspacing="0" style="width:100%;text-align:left;">
        <tr style="text-align:center;">
            <td>
                @Html.DropDownList("selStation", new SelectList(costlist, "value", "key", ViewBag.cost) , new { onchange = "change_cost(this.value);" })
                <input type="button" style="width:100px;" value="通過" onclick="if ($('input[name=id_list]:checked').length > 0) { $('#status').val('Y'); submit(); } else { alert('請選擇申請清單!'); }" />
                <input type="button" style="width:100px;" value="不通過" onclick="if ($('input[name=id_list]:checked').length > 0) { $('#status').val('N'); submit(); } else { alert('請選擇申請清單!'); }" />
            </td>
        </tr>
        <tr>
            <td style="width:100%;">
                <div class="dataHeader">
                    <table border="0" cellpadding="4" cellspacing="1" style="width:100%;">
                        <tr>
                            <td colspan="5">申請清單</td>
                        </tr>
                        <tr>
                            <td style="width:5%;"><input type="checkbox" onclick="click_all(this);" /></td>
                            <td style="width:10%;">申請者</td>
                            <td style="width:20%;">權限名稱</td>
                            <td style="width:45%;">申請原因</td>
                            <td style="width:20%;">申請時間</td>
                        </tr>
                    </table>
                </div>
                <div class="dataArea" style="height:345px;">
                    @if(dt_complement_list != null)
                    {
                    <table border="0" cellpadding="4" cellspacing="1" width="100%" style="width:100%;table-layout:fixed;">
                        @foreach(DataRow r in dt_complement_list.Rows)
                        {
                        <tr class="@r["APL_COST_ID"]" style="display:none;">
                            <td style="width:5%;text-align:center;"><input type="checkbox" name="id_list" value="@r["C_ID"]" /></td>
                            <td style="width:10%;text-align:center;">@r["APL_NANE"]</td>
                            <td style="width:20%;"></td>
                            <td style="width:45%;">@r["APL_REASON"]</td>
                            <td style="width:20%;text-align:center;">@Convert.ToDateTime(r["APL_TIME"]).ToString("yyyy/MM/dd HH:mm")</td>
                        </tr>
                        }
                    </table>
                    }
                </div>
            </td>
        </tr>
    </table>
</div>
</form>